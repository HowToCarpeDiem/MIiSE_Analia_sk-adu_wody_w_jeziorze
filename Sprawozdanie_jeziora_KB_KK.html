<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kamil Burza, Kornel Korbas">

<title>Analiza składu jeziora</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Sprawozdanie_jeziora_KB_KK_files/libs/clipboard/clipboard.min.js"></script>
<script src="Sprawozdanie_jeziora_KB_KK_files/libs/quarto-html/quarto.js"></script>
<script src="Sprawozdanie_jeziora_KB_KK_files/libs/quarto-html/popper.min.js"></script>
<script src="Sprawozdanie_jeziora_KB_KK_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Sprawozdanie_jeziora_KB_KK_files/libs/quarto-html/anchor.min.js"></script>
<link href="Sprawozdanie_jeziora_KB_KK_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Sprawozdanie_jeziora_KB_KK_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Sprawozdanie_jeziora_KB_KK_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Sprawozdanie_jeziora_KB_KK_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Sprawozdanie_jeziora_KB_KK_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bibilioteki" id="toc-bibilioteki" class="nav-link active" data-scroll-target="#bibilioteki">1. Bibilioteki</a></li>
  <li><a href="#dane" id="toc-dane" class="nav-link" data-scroll-target="#dane">2. Dane</a>
  <ul class="collapse">
  <li><a href="#wczytanie-danych-i-usunięcie-pustych-wierszy" id="toc-wczytanie-danych-i-usunięcie-pustych-wierszy" class="nav-link" data-scroll-target="#wczytanie-danych-i-usunięcie-pustych-wierszy">2.1 Wczytanie danych i usunięcie pustych wierszy</a></li>
  <li><a href="#przedstawienie-danych" id="toc-przedstawienie-danych" class="nav-link" data-scroll-target="#przedstawienie-danych">2.2 Przedstawienie danych</a></li>
  <li><a href="#opis-danych" id="toc-opis-danych" class="nav-link" data-scroll-target="#opis-danych">2.3 Opis danych</a></li>
  <li><a href="#statystyki-opisowe" id="toc-statystyki-opisowe" class="nav-link" data-scroll-target="#statystyki-opisowe">2.4 Statystyki opisowe</a></li>
  </ul></li>
  <li><a href="#wykresy" id="toc-wykresy" class="nav-link" data-scroll-target="#wykresy">3. Wykresy</a>
  <ul class="collapse">
  <li><a href="#macierz-wykresów-podpunktowych" id="toc-macierz-wykresów-podpunktowych" class="nav-link" data-scroll-target="#macierz-wykresów-podpunktowych">3.1 Macierz wykresów podpunktowych</a></li>
  <li><a href="#histogramy" id="toc-histogramy" class="nav-link" data-scroll-target="#histogramy">3.2 Histogramy</a></li>
  <li><a href="#wykresy-korelacji-pearsona-i-spearmana-z-wnioskami" id="toc-wykresy-korelacji-pearsona-i-spearmana-z-wnioskami" class="nav-link" data-scroll-target="#wykresy-korelacji-pearsona-i-spearmana-z-wnioskami">3.3 Wykresy korelacji Pearsona i Spearmana z wnioskami</a></li>
  <li><a href="#wykres-autokorelacji" id="toc-wykres-autokorelacji" class="nav-link" data-scroll-target="#wykres-autokorelacji">3.4 Wykres autokorelacji</a></li>
  </ul></li>
  <li><a href="#obliczanie-its" id="toc-obliczanie-its" class="nav-link" data-scroll-target="#obliczanie-its">4. Obliczanie ITS</a></li>
  <li><a href="#testy-normalności" id="toc-testy-normalności" class="nav-link" data-scroll-target="#testy-normalności">5. Testy normalności</a>
  <ul class="collapse">
  <li><a href="#test-shapiro" id="toc-test-shapiro" class="nav-link" data-scroll-target="#test-shapiro">5.1 Test Shapiro</a></li>
  <li><a href="#test-kurtozy" id="toc-test-kurtozy" class="nav-link" data-scroll-target="#test-kurtozy">5.2 Test Kurtozy</a></li>
  <li><a href="#test-kołmogorowa" id="toc-test-kołmogorowa" class="nav-link" data-scroll-target="#test-kołmogorowa">5.3 Test Kołmogorowa</a></li>
  <li><a href="#test-andersena-darlinga" id="toc-test-andersena-darlinga" class="nav-link" data-scroll-target="#test-andersena-darlinga">5.4 Test Andersena-Darlinga</a></li>
  <li><a href="#test-lillieforsa" id="toc-test-lillieforsa" class="nav-link" data-scroll-target="#test-lillieforsa">5.5 Test Lillieforsa</a></li>
  <li><a href="#wspólne-wnioski-z-testów-normalności-dla-zmiennych" id="toc-wspólne-wnioski-z-testów-normalności-dla-zmiennych" class="nav-link" data-scroll-target="#wspólne-wnioski-z-testów-normalności-dla-zmiennych">5.6 Wspólne wnioski z testów normalności dla zmiennych</a></li>
  <li><a href="#podsumowanie-i-rekomendacje" id="toc-podsumowanie-i-rekomendacje" class="nav-link" data-scroll-target="#podsumowanie-i-rekomendacje">Podsumowanie i rekomendacje</a></li>
  </ul></li>
  <li><a href="#testy-odstające" id="toc-testy-odstające" class="nav-link" data-scroll-target="#testy-odstające">6. Testy odstające</a>
  <ul class="collapse">
  <li><a href="#grubbs" id="toc-grubbs" class="nav-link" data-scroll-target="#grubbs">6.1 Grubbs</a></li>
  <li><a href="#dixon" id="toc-dixon" class="nav-link" data-scroll-target="#dixon">6.2 Dixon</a></li>
  <li><a href="#rosner" id="toc-rosner" class="nav-link" data-scroll-target="#rosner">6.3 Rosner</a></li>
  <li><a href="#wnioski-z-testów-grubbsa-dixona-i-rosnera-dla-wartości-its" id="toc-wnioski-z-testów-grubbsa-dixona-i-rosnera-dla-wartości-its" class="nav-link" data-scroll-target="#wnioski-z-testów-grubbsa-dixona-i-rosnera-dla-wartości-its">6.4 Wnioski z testów Grubbsa, Dixona i Rosnera dla wartości ITS</a></li>
  <li><a href="#rekomendacje" id="toc-rekomendacje" class="nav-link" data-scroll-target="#rekomendacje">Rekomendacje</a></li>
  </ul></li>
  <li><a href="#regresja-liniowa" id="toc-regresja-liniowa" class="nav-link" data-scroll-target="#regresja-liniowa">7. Regresja liniowa</a>
  <ul class="collapse">
  <li><a href="#model-regresji-liniowej" id="toc-model-regresji-liniowej" class="nav-link" data-scroll-target="#model-regresji-liniowej">7.1 Model regresji liniowej</a></li>
  <li><a href="#statystyki-modelu" id="toc-statystyki-modelu" class="nav-link" data-scroll-target="#statystyki-modelu">7.2 Statystyki modelu</a></li>
  <li><a href="#wyniki-testu-współliniowości-vif" id="toc-wyniki-testu-współliniowości-vif" class="nav-link" data-scroll-target="#wyniki-testu-współliniowości-vif">7.3 Wyniki testu współliniowości (VIF):**</a></li>
  <li><a href="#wykresy-reszt" id="toc-wykresy-reszt" class="nav-link" data-scroll-target="#wykresy-reszt">7.4 Wykresy reszt</a></li>
  <li><a href="#interpretacja-wykresów-diagnostycznych" id="toc-interpretacja-wykresów-diagnostycznych" class="nav-link" data-scroll-target="#interpretacja-wykresów-diagnostycznych">7.5 Interpretacja wykresów diagnostycznych:</a></li>
  </ul></li>
  <li><a href="#przykładowa-predykcja-z-wykorzystaniem-naszego-modelu-regresji" id="toc-przykładowa-predykcja-z-wykorzystaniem-naszego-modelu-regresji" class="nav-link" data-scroll-target="#przykładowa-predykcja-z-wykorzystaniem-naszego-modelu-regresji">8. Przykładowa predykcja z wykorzystaniem naszego modelu regresji</a>
  <ul class="collapse">
  <li><a href="#stworzenie-próbnych-danych" id="toc-stworzenie-próbnych-danych" class="nav-link" data-scroll-target="#stworzenie-próbnych-danych">8.1 Stworzenie próbnych danych</a></li>
  <li><a href="#predykcja-its" id="toc-predykcja-its" class="nav-link" data-scroll-target="#predykcja-its">8.2 Predykcja ITS</a></li>
  <li><a href="#wnioski-predykcji" id="toc-wnioski-predykcji" class="nav-link" data-scroll-target="#wnioski-predykcji">Wnioski predykcji:</a></li>
  </ul></li>
  <li><a href="#model-regresji-wielomianowej" id="toc-model-regresji-wielomianowej" class="nav-link" data-scroll-target="#model-regresji-wielomianowej">9. Model regresji wielomianowej</a>
  <ul class="collapse">
  <li><a href="#dodanie-numeru-wiersza-jako-zmiennej-w-ramce-danych" id="toc-dodanie-numeru-wiersza-jako-zmiennej-w-ramce-danych" class="nav-link" data-scroll-target="#dodanie-numeru-wiersza-jako-zmiennej-w-ramce-danych">9.1 Dodanie numeru wiersza jako zmiennej w ramce danych</a></li>
  <li><a href="#wykres-regresji-liniowej-dla-its" id="toc-wykres-regresji-liniowej-dla-its" class="nav-link" data-scroll-target="#wykres-regresji-liniowej-dla-its">9.2 Wykres regresji liniowej dla ITS</a></li>
  <li><a href="#dopasowanie-modelu-wielomianowego-drugiego-stopnia" id="toc-dopasowanie-modelu-wielomianowego-drugiego-stopnia" class="nav-link" data-scroll-target="#dopasowanie-modelu-wielomianowego-drugiego-stopnia">9.3 Dopasowanie modelu wielomianowego drugiego stopnia</a></li>
  <li><a href="#przewidywanie-wartości" id="toc-przewidywanie-wartości" class="nav-link" data-scroll-target="#przewidywanie-wartości">9.4 Przewidywanie wartości</a></li>
  <li><a href="#wykres-regresji-wielomianowej-dla-its" id="toc-wykres-regresji-wielomianowej-dla-its" class="nav-link" data-scroll-target="#wykres-regresji-wielomianowej-dla-its">9.5 Wykres regresji wielomianowej dla ITS</a></li>
  <li><a href="#model-regresji-liniowej-dla-its-i-chla" id="toc-model-regresji-liniowej-dla-its-i-chla" class="nav-link" data-scroll-target="#model-regresji-liniowej-dla-its-i-chla">9.6 Model regresji liniowej dla ITS i Chla</a></li>
  <li><a href="#model-regresji-wielomianowej-dla-its-i-chla" id="toc-model-regresji-wielomianowej-dla-its-i-chla" class="nav-link" data-scroll-target="#model-regresji-wielomianowej-dla-its-i-chla">9.7 Model regresji wielomianowej dla ITS i Chla</a></li>
  </ul></li>
  <li><a href="#optymalizacja-modelu-dla-its" id="toc-optymalizacja-modelu-dla-its" class="nav-link" data-scroll-target="#optymalizacja-modelu-dla-its">10. Optymalizacja modelu dla ITS</a>
  <ul class="collapse">
  <li><a href="#kryterium-informacyjne-akaikego-aic." id="toc-kryterium-informacyjne-akaikego-aic." class="nav-link" data-scroll-target="#kryterium-informacyjne-akaikego-aic.">10.1 Kryterium Informacyjne Akaikego (AIC).</a></li>
  <li><a href="#kombninacje-zmiennych" id="toc-kombninacje-zmiennych" class="nav-link" data-scroll-target="#kombninacje-zmiennych">10.2 Kombninacje zmiennych</a></li>
  <li><a href="#drzewo-decyzyjne" id="toc-drzewo-decyzyjne" class="nav-link" data-scroll-target="#drzewo-decyzyjne">10.3 Drzewo decyzyjne</a></li>
  <li><a href="#model-caret---rpart" id="toc-model-caret---rpart" class="nav-link" data-scroll-target="#model-caret---rpart">10.4 Model caret - rpart</a></li>
  <li><a href="#model-caret---bagearth" id="toc-model-caret---bagearth" class="nav-link" data-scroll-target="#model-caret---bagearth">10.5 Model caret - bagEarth</a></li>
  <li><a href="#model-caret---glmboot" id="toc-model-caret---glmboot" class="nav-link" data-scroll-target="#model-caret---glmboot">10.6 Model caret - glmboot</a></li>
  </ul></li>
  <li><a href="#optymalizacja-modelu-dla-chla" id="toc-optymalizacja-modelu-dla-chla" class="nav-link" data-scroll-target="#optymalizacja-modelu-dla-chla">11 Optymalizacja modelu dla chla</a>
  <ul class="collapse">
  <li><a href="#kombninacje-zmiennych-1" id="toc-kombninacje-zmiennych-1" class="nav-link" data-scroll-target="#kombninacje-zmiennych-1">11.1 Kombninacje zmiennych</a></li>
  <li><a href="#drzewo-decyzyjne-1" id="toc-drzewo-decyzyjne-1" class="nav-link" data-scroll-target="#drzewo-decyzyjne-1">11.2 Drzewo decyzyjne</a></li>
  <li><a href="#model-caret---rpart-1" id="toc-model-caret---rpart-1" class="nav-link" data-scroll-target="#model-caret---rpart-1">11.3 Model caret - rpart</a></li>
  <li><a href="#model-11.4-model-caret---bagearth" id="toc-model-11.4-model-caret---bagearth" class="nav-link" data-scroll-target="#model-11.4-model-caret---bagearth">Model 11.4 Model caret - bagEarth</a></li>
  <li><a href="#model-caret---glmboost" id="toc-model-caret---glmboost" class="nav-link" data-scroll-target="#model-caret---glmboost">11.5 Model caret - glmboost</a></li>
  </ul></li>
  <li><a href="#macierz-its" id="toc-macierz-its" class="nav-link" data-scroll-target="#macierz-its">12. Macierz ITS</a>
  <ul class="collapse">
  <li><a href="#tworzenie-kombinacji-wag" id="toc-tworzenie-kombinacji-wag" class="nav-link" data-scroll-target="#tworzenie-kombinacji-wag">12.1 Tworzenie kombinacji wag</a></li>
  <li><a href="#tworzenie-macierzy" id="toc-tworzenie-macierzy" class="nav-link" data-scroll-target="#tworzenie-macierzy">12.2 Tworzenie macierzy</a></li>
  <li><a href="#tworzenie-modeli-dla-różnych-kombinacji-wag" id="toc-tworzenie-modeli-dla-różnych-kombinacji-wag" class="nav-link" data-scroll-target="#tworzenie-modeli-dla-różnych-kombinacji-wag">12.3 Tworzenie modeli dla różnych kombinacji wag</a></li>
  <li><a href="#tworzenie-heatmapy" id="toc-tworzenie-heatmapy" class="nav-link" data-scroll-target="#tworzenie-heatmapy">12.4 Tworzenie heatmapy</a></li>
  </ul></li>
  <li><a href="#ocena-dopasowania-modeli-hydrologicznych" id="toc-ocena-dopasowania-modeli-hydrologicznych" class="nav-link" data-scroll-target="#ocena-dopasowania-modeli-hydrologicznych">13 Ocena dopasowania modeli hydrologicznych</a>
  <ul class="collapse">
  <li><a href="#obliczenie-metryk-dopasowania-modelu" id="toc-obliczenie-metryk-dopasowania-modelu" class="nav-link" data-scroll-target="#obliczenie-metryk-dopasowania-modelu">13.1 Obliczenie metryk dopasowania modelu</a></li>
  <li><a href="#analiza-błędów-modelu" id="toc-analiza-błędów-modelu" class="nav-link" data-scroll-target="#analiza-błędów-modelu">13.2 Analiza błędów modelu</a></li>
  <li><a href="#eksploracja-zmiennych-przyczynowych--sem" id="toc-eksploracja-zmiennych-przyczynowych--sem" class="nav-link" data-scroll-target="#eksploracja-zmiennych-przyczynowych--sem">13.3 Eksploracja zmiennych przyczynowych- SEM</a></li>
  <li><a href="#wykres-ścieżek" id="toc-wykres-ścieżek" class="nav-link" data-scroll-target="#wykres-ścieżek">13.4 Wykres ścieżek</a></li>
  </ul></li>
  <li><a href="#metody-regularyzacji-ridge-i-lasso" id="toc-metody-regularyzacji-ridge-i-lasso" class="nav-link" data-scroll-target="#metody-regularyzacji-ridge-i-lasso">14. Metody regularyzacji (Ridge i Lasso)</a></li>
  <li><a href="#gam-model" id="toc-gam-model" class="nav-link" data-scroll-target="#gam-model">15. Gam model</a></li>
  <li><a href="#inne-wykresy" id="toc-inne-wykresy" class="nav-link" data-scroll-target="#inne-wykresy">16. Inne wykresy</a>
  <ul class="collapse">
  <li><a href="#zależność-między-chlorofilem-a-its" id="toc-zależność-między-chlorofilem-a-its" class="nav-link" data-scroll-target="#zależność-między-chlorofilem-a-its">16.1 Zależność między chlorofilem a ITS</a></li>
  <li><a href="#rozkład-chlorofilu" id="toc-rozkład-chlorofilu" class="nav-link" data-scroll-target="#rozkład-chlorofilu">16.2 Rozkład chlorofilu</a></li>
  <li><a href="#zależność-między-chlorofilem-its-i-przewodnością" id="toc-zależność-między-chlorofilem-its-i-przewodnością" class="nav-link" data-scroll-target="#zależność-między-chlorofilem-its-i-przewodnością">16.3 Zależność między chlorofilem, ITS i przewodnością</a></li>
  <li><a href="#rozkład-its-w-różnych-kategoriach-wody" id="toc-rozkład-its-w-różnych-kategoriach-wody" class="nav-link" data-scroll-target="#rozkład-its-w-różnych-kategoriach-wody">16.4 Rozkład ITS w różnych kategoriach wody</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analiza składu jeziora</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kamil Burza, Kornel Korbas </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="bibilioteki" class="level2">
<h2 class="anchored" data-anchor-id="bibilioteki">1. Bibilioteki</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes) <span class="co"># Do ggplot2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># Do predykcji</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071) <span class="co"># Test kurtozy</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dgof) <span class="co"># Test Kołomogorowa</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(combinat) <span class="co"># ?</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(outliers) <span class="co"># Test grubbsona</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats) <span class="co"># Test rosnera</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest) <span class="co"># Test Andersena-Darlinga oraz Lillieforsa</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mboost)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps) <span class="co">#subs</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hydroGOF)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan) <span class="co"># Eksploracja zmiennych przyczynowych (Causal Analysis)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co"># Model bayesowski</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdp)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dane" class="level2">
<h2 class="anchored" data-anchor-id="dane">2. Dane</h2>
<section id="wczytanie-danych-i-usunięcie-pustych-wierszy" class="level3">
<h3 class="anchored" data-anchor-id="wczytanie-danych-i-usunięcie-pustych-wierszy">2.1 Wczytanie danych i usunięcie pustych wierszy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dane2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"D:/d.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dane2 &lt;- read_csv("D:/d.csv")</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(dane2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="przedstawienie-danych" class="level3">
<h3 class="anchored" data-anchor-id="przedstawienie-danych">2.2 Przedstawienie danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dane, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
   chla  temp   bar   nas przew    ph namon
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1   1.1  12      10  80.8   176  7.4  0.1  
2   2.5  15.2    20  89.7   157  7.6  0.1  
3   8.6  19       5  87.5   207  8    0.05 
4   2.3  19.5    10  83.5   189  7.67 0.05 
5   7.5  12       0 108.    122  8.2  0.004</code></pre>
</div>
</div>
</section>
<section id="opis-danych" class="level3">
<h3 class="anchored" data-anchor-id="opis-danych">2.3 Opis danych</h3>
<section id="dane-dostarczają-informacji-na-temat-składu-wody-w-jeziorze." class="level4">
<h4 class="anchored" data-anchor-id="dane-dostarczają-informacji-na-temat-składu-wody-w-jeziorze.">Dane dostarczają informacji na temat składu wody w jeziorze.</h4>
<ul>
<li><strong>chla</strong> – Stężenie chlorofilu-a, które wskazuje na poziom fitoplanktonu i może być używane do monitorowania eutrofizacji (nadmiaru składników odżywczych w wodzie).<br>
</li>
<li><strong>temp</strong> – Temperatura wody, ważna dla analizy warunków środowiskowych wpływających na organizmy wodne.<br>
</li>
<li><strong>bar</strong> – Ciśnienie barometryczne, które może być uwzględniane w kontekście warunków atmosferycznych wpływających na wodę.<br>
</li>
<li><strong>nas</strong> – Przewodność (lub inny parametr związany z zasoleniem), wskazująca na stężenie rozpuszczonych jonów w wodzie.<br>
</li>
<li><strong>przew</strong> – Przewodność właściwa (elektryczna), informująca o mineralizacji wody.<br>
</li>
<li><strong>ph</strong> – Odczyn wody, kluczowy dla oceny kwasowości/zasadowości i zdrowia ekosystemu wodnego.<br>
</li>
<li><strong>namon</strong> – Stężenie amoniaku, które może być wskaźnikiem zanieczyszczenia organicznego lub procesu dekompozycji.</li>
</ul>
</section>
</section>
<section id="statystyki-opisowe" class="level3">
<h3 class="anchored" data-anchor-id="statystyki-opisowe">2.4 Statystyki opisowe</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      chla            temp            bar             nas        
 Min.   : 1.10   Min.   : 8.00   Min.   : 0.00   Min.   : 42.07  
 1st Qu.: 7.90   1st Qu.:13.00   1st Qu.:10.00   1st Qu.: 89.37  
 Median :19.00   Median :16.60   Median :20.00   Median :100.43  
 Mean   :21.75   Mean   :15.96   Mean   :17.55   Mean   : 99.62  
 3rd Qu.:26.90   3rd Qu.:18.90   3rd Qu.:20.00   3rd Qu.:108.08  
 Max.   :97.00   Max.   :22.50   Max.   :40.00   Max.   :131.06  
     przew             ph            namon       
 Min.   :122.0   Min.   :7.200   Min.   :0.0000  
 1st Qu.:176.0   1st Qu.:7.950   1st Qu.:0.1000  
 Median :191.0   Median :8.290   Median :0.1000  
 Mean   :201.2   Mean   :8.289   Mean   :0.1164  
 3rd Qu.:209.5   3rd Qu.:8.700   3rd Qu.:0.1600  
 Max.   :403.0   Max.   :9.300   Max.   :0.2400  </code></pre>
</div>
</div>
</section>
</section>
<section id="wykresy" class="level2">
<h2 class="anchored" data-anchor-id="wykresy">3. Wykresy</h2>
<section id="macierz-wykresów-podpunktowych" class="level3">
<h3 class="anchored" data-anchor-id="macierz-wykresów-podpunktowych">3.1 Macierz wykresów podpunktowych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># WYKRES</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] , <span class="at">pch=</span><span class="dv">20</span> , <span class="at">cex=</span><span class="fl">1.5</span> , <span class="at">col=</span><span class="st">"#69b3a2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Temperatura i przewodność wydają się być skorelowane, co jest zgodne z fizykochemicznymi właściwościami wody. Stężenie amoniaku może być powiązane z pH, co ma znaczenie dla oceny toksyczności amoniaku w wodzie.</p>
</section>
<section id="histogramy" class="level3">
<h3 class="anchored" data-anchor-id="histogramy">3.2 Histogramy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HISTOGRAMY</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes_string</span>(<span class="at">x =</span> column_name)) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Histogram for"</span>, column_name))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  plots[[i]] <span class="ot">&lt;-</span> plot</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlamy wszystkie wykresy w układzie 2x4 (lub innym w zależności od liczby wykresów)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">ncol =</span> <span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="analiza-histogramów-zmiennych-związanych-z-jakością-wody" class="level4">
<h4 class="anchored" data-anchor-id="analiza-histogramów-zmiennych-związanych-z-jakością-wody">Analiza histogramów zmiennych związanych z jakością wody</h4>
<ul>
<li><p><strong>Chlorofil-a (chla):</strong><br>
Rozkład jest skośny w prawo, z dużą liczbą mniejszych wartości stężenia chlorofilu-a. Wysokie stężenia są rzadkością. Może to sugerować, że większość próbek pochodzi z jeziora o umiarkowanym lub niskim poziomie eutrofizacji, a epizody wyższego stężenia chlorofilu są sporadyczne.</p></li>
<li><p><strong>Temperatura wody (temp):</strong><br>
Dane dotyczące temperatury wody są rozłożone dość równomiernie w zakresie od około 10°C do 20°C, z nieco większą koncentracją obserwacji w przedziale 14-18°C. Wskazuje to na pomiary przeprowadzane w umiarkowanych temperaturach, typowych dla sezonu letniego lub przejściowego.</p></li>
<li><p><strong>Ciśnienie barometryczne (bar):</strong><br>
Histogram pokazuje dużą koncentrację pomiarów wokół jednej wartości (~20). Sugeruje to, że ciśnienie było względnie stałe w trakcie pomiarów, co może oznaczać ograniczoną zmienność warunków atmosferycznych.</p></li>
<li><p><strong>Przewodność (nas):</strong><br>
Rozkład jest bliski normalnemu z lekkim przesunięciem. Najwięcej próbek znajduje się w przedziale 80-120 µS/cm, co wskazuje na typowe zasolenie dla badanego jeziora.</p></li>
<li><p><strong>Przewodność właściwa (przew):</strong><br>
Histogram wskazuje na bimodalny rozkład, co może oznaczać dwa różne stany wody lub różne typy próbek. Największe zagęszczenie występuje w okolicach 200 i 300 µS/cm.</p></li>
<li><p><strong>pH:</strong><br>
Rozkład pH pokazuje, że większość wartości mieści się między 7,5 a 9, co jest zgodne z typowymi zakresami pH dla jezior słodkowodnych o umiarkowanej zasadowości.</p></li>
<li><p><strong>Stężenie amoniaku (namon):</strong><br>
Histogram jest wyraźnie skośny w prawo z dominującymi bardzo małymi wartościami amoniaku. Wysokie stężenia występują rzadko, co sugeruje, że większość pomiarów dotyczy wody o niskim poziomie zanieczyszczenia związkami amonowymi.</p></li>
</ul>
</section>
</section>
<section id="wykresy-korelacji-pearsona-i-spearmana-z-wnioskami" class="level3">
<h3 class="anchored" data-anchor-id="wykresy-korelacji-pearsona-i-spearmana-z-wnioskami">3.3 Wykresy korelacji Pearsona i Spearmana z wnioskami</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Mdane <span class="ot">=</span> <span class="fu">cor</span>(dane, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(Mdane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Mdane_sp <span class="ot">=</span> <span class="fu">cor</span>(dane, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(Mdane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Chlorofil-a (chla):</strong> Współczynnik korelacji Pearsona wskazuje na umiarkowaną dodatnią korelację z temperaturą (temp) oraz przewodnością (przew). Silna dodatnia korelacja występuje z wartościami ciśnienia barometrycznego (bar). Korelacja Spearmana potwierdza te zależności, choć wykazuje nieco silniejsze powiązania. Może to sugerować, że wyższe poziomy chlorofilu-a są związane z cieplejszą wodą i wyższym ciśnieniem.</p></li>
<li><p><strong>Temperatura wody (temp):</strong> Wykazuje pozytywną korelację z chlorofilem-a (chla) oraz przewodnością (przew). Korelacja Spearmana jest podobna, co wskazuje na stabilne relacje między tymi zmiennymi. Może to świadczyć o tym, że podwyższenie temperatury sprzyja rozwojowi fitoplanktonu.</p></li>
<li><p><strong>Ciśnienie barometryczne (bar):</strong> Wysoka dodatnia korelacja z chlorofilem-a (chla). Wskazuje to, że wzrost ciśnienia atmosferycznego może być związany z wyższymi stężeniami chlorofilu-a.</p></li>
<li><p><strong>Przewodność (nas):</strong> Korelacja jest silna z przewodnością właściwą (przew), co jest spodziewanym wynikiem ze względu na związki fizyczne tych parametrów.</p></li>
<li><p><strong>Przewodność właściwa (przew):</strong> Dodatnia korelacja z temperaturą oraz chlorofilem-a wskazuje na powiązanie z jakością wody i jej właściwościami chemicznymi. Może to wynikać z obecności składników odżywczych sprzyjających rozwojowi fitoplanktonu.</p></li>
<li><p><strong>pH:</strong> Korelacje z innymi zmiennymi są stosunkowo słabe lub umiarkowane, ale widoczna jest umiarkowana ujemna korelacja z chlorofilem-a, co może wskazywać na wpływ kwasowości na rozwój fitoplanktonu.</p></li>
<li><p><strong>Stężenie amoniaku (namon):</strong> Korelacje są generalnie słabe, ale dodatnia korelacja z przewodnością (przew) może sugerować związki z jakością wody, choć nie są one silne.</p></li>
</ul>
</section>
<section id="wykres-autokorelacji" class="level3">
<h3 class="anchored" data-anchor-id="wykres-autokorelacji">3.4 Wykres autokorelacji</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AUTOKORELACJA</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">lag =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Chlorofil-a (chla):</strong> Brak istotnej autokorelacji dla lagów większych niż 0, co sugeruje, że zmienność chlorofilu-a w próbkach nie wykazuje wyraźnych wzorców czasowych lub powtarzających się trendów.</p></li>
<li><p><strong>Temperatura wody (temp):</strong> Nie zaobserwowano istotnej autokorelacji dla wyższych lagów, co wskazuje na brak silnej sezonowej zależności w badanym okresie.</p></li>
<li><p><strong>Ciśnienie barometryczne (bar):</strong> Niski poziom autokorelacji sugeruje stabilność warunków atmosferycznych i brak długoterminowych cyklicznych zmian.</p></li>
<li><p><strong>Przewodność (nas):</strong> Autokorelacja jest niewielka dla wszystkich lagów, co oznacza brak wyraźnych cyklicznych wzorców.</p></li>
<li><p><strong>Przewodność właściwa (przew):</strong> Podobnie jak dla przewodności, autokorelacja nie wskazuje na istotne zależności czasowe.</p></li>
<li><p><strong>pH:</strong> Brak znaczącej autokorelacji oznacza, że poziomy pH w czasie są losowe lub niepowiązane w długoterminowych trendach.</p></li>
<li><p><strong>Stężenie amoniaku (namon):</strong> Brak istotnej autokorelacji sugeruje, że zmienność poziomów amoniaku jest przypadkowa i nie zależy od wcześniejszych wartości pomiarowych.</p></li>
</ul>
<p>Wnioski te wskazują, że dane nie wykazują silnych cyklicznych wzorców ani trendów czasowych, co jest typowe dla krótkookresowych pomiarów bez wyraźnego wpływu sezonowości.</p>
</section>
</section>
<section id="obliczanie-its" class="level2">
<h2 class="anchored" data-anchor-id="obliczanie-its">4. Obliczanie ITS</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ITS</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dane<span class="sc">$</span>ITS <span class="ot">&lt;-</span> dane<span class="sc">$</span>ph <span class="sc">+</span> <span class="fl">0.013</span> <span class="sc">*</span> (<span class="dv">100</span><span class="sc">-</span>dane<span class="sc">$</span>nas) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>its_values <span class="ot">&lt;-</span> <span class="fu">sort</span>(dane<span class="sc">$</span>ITS)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>its_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 7.64986 7.73416 7.76419 7.77787 7.81359 7.82145 7.88450 7.94118 7.95309
[10] 7.96315 7.97166 7.97654 7.99441 7.99584 8.00107 8.03777 8.06536 8.07738
[19] 8.08749 8.09210 8.10793 8.16250 8.16529 8.17592 8.23520 8.35333 8.35370
[28] 8.39958 8.40419 8.42151 8.42697 8.44417 8.44446 8.48238 8.49782 8.51462
[37] 8.51849 8.51969 8.52560 8.57231 8.61330 8.65424 8.68388 8.71215 8.74361
[46] 8.76815 8.82574 8.86785 8.89622 8.94338 8.94523</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dane</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51 × 8
    chla  temp   bar   nas przew    ph namon   ITS
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1   1.1  12      10  80.8   176  7.4  0.1    7.65
 2   2.5  15.2    20  89.7   157  7.6  0.1    7.73
 3   8.6  19       5  87.5   207  8    0.05   8.16
 4   2.3  19.5    10  83.5   189  7.67 0.05   7.88
 5   7.5  12       0 108.    122  8.2  0.004  8.09
 6  10.3  21.5     5  94.2   202  8.1  0.14   8.18
 7   3.7  12.5    20  83.6   181  7.6  0.1    7.81
 8   8.6  15.6    10  87.4   155  7.8  0.1    7.96
 9  39.2  15.2    20 108.    206  8.1  0.2    8.00
10  19    19      40 100.    191  8    0      8.00
# ℹ 41 more rows</code></pre>
</div>
</div>
</section>
<section id="testy-normalności" class="level2">
<h2 class="anchored" data-anchor-id="testy-normalności">5. Testy normalności</h2>
<section id="test-shapiro" class="level3">
<h3 class="anchored" data-anchor-id="test-shapiro">5.1 Test Shapiro</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TEST</span><span class="co"> SHAPIRO</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>wyniki_shapiro <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Shapiro_p_value =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  test_shapiro <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(dane[[column_name]]) </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  wyniki_shapiro <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_shapiro, <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> column_name, <span class="at">Shapiro_p_value =</span> test_shapiro<span class="sc">$</span>p.value))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>wyniki_shapiro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Column_Name Shapiro_p_value
1        chla    2.662807e-06
2        temp    2.375079e-01
3         bar    9.184571e-04
4         nas    2.357151e-02
5       przew    4.673650e-07
6          ph    4.409816e-01
7       namon    9.530576e-04
8         ITS    9.260320e-02</code></pre>
</div>
</div>
</section>
<section id="test-kurtozy" class="level3">
<h3 class="anchored" data-anchor-id="test-kurtozy">5.2 Test Kurtozy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TEST</span><span class="co"> KUROZY</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>wyniki_kurtoza <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Kurtosis_value =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]  <span class="co"># Nazwa kolumny</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  test_kurtozy <span class="ot">&lt;-</span> <span class="fu">kurtosis</span>(dane[[column_name]])  <span class="co"># Obliczenie kurtozy</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  wyniki_kurtoza <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_kurtoza, <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> column_name, <span class="at">Kurtosis_value =</span> test_kurtozy))  <span class="co"># Dodanie wyniku</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>wyniki_kurtoza</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Column_Name Kurtosis_value
1        chla      3.2884627
2        temp     -0.7110395
3         bar     -0.1074602
4         nas      2.9792626
5       przew      8.2411511
6          ph     -0.5804069
7       namon     -0.3391272
8         ITS     -1.0423589</code></pre>
</div>
</div>
</section>
<section id="test-kołmogorowa" class="level3">
<h3 class="anchored" data-anchor-id="test-kołmogorowa">5.3 Test Kołmogorowa</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wyniki_kolmogorow <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Kolo_p_value =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  col_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(dane[[column_name]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  col_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(dane[[column_name]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  test_kolo <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(dane[[column_name]], <span class="st">"pnorm"</span>, <span class="at">mean =</span> col_mean, <span class="at">sd =</span> col_sd)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  wyniki_kolmogorow <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_kolmogorow, <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> column_name, <span class="at">Kolo_p_value =</span> test_kolo<span class="sc">$</span>p.value))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>wyniki_kolmogorow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Column_Name Kolo_p_value
1        chla   0.06283501
2        temp   0.69974920
3         bar   0.02591215
4         nas   0.92015257
5       przew   0.03660339
6          ph   0.63773790
7       namon   0.01338117
8         ITS   0.51884857</code></pre>
</div>
</div>
</section>
<section id="test-andersena-darlinga" class="level3">
<h3 class="anchored" data-anchor-id="test-andersena-darlinga">5.4 Test Andersena-Darlinga</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wyniki_anderson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">AD_p_value =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  col_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(dane[[column_name]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  col_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(dane[[column_name]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  standardized_data <span class="ot">&lt;-</span> (dane[[column_name]] <span class="sc">-</span> col_mean) <span class="sc">/</span> col_sd</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  test_ad <span class="ot">&lt;-</span> <span class="fu">ad.test</span>(standardized_data)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  wyniki_anderson <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_anderson, <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> column_name, <span class="at">AD_p_value =</span> test_ad<span class="sc">$</span>p.value))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>wyniki_anderson</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Column_Name   AD_p_value
1        chla 6.226789e-07
2        temp 1.126171e-01
3         bar 4.257636e-05
4         nas 3.301262e-01
5       przew 7.271831e-07
6          ph 3.415438e-01
7       namon 1.626473e-05
8         ITS 8.813676e-02</code></pre>
</div>
</div>
</section>
<section id="test-lillieforsa" class="level3">
<h3 class="anchored" data-anchor-id="test-lillieforsa">5.5 Test Lillieforsa</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wyniki_lilliefors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Lillie_p_value =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  column_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  test_lillie <span class="ot">&lt;-</span> <span class="fu">lillie.test</span>(dane[[column_name]])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  wyniki_lilliefors <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_lilliefors, <span class="fu">data.frame</span>(<span class="at">Column_Name =</span> column_name, <span class="at">Lillie_p_value =</span> test_lillie<span class="sc">$</span>p.value))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>wyniki_lilliefors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Column_Name Lillie_p_value
1        chla   1.665081e-04
2        temp   2.424576e-01
3         bar   1.025983e-05
4         nas   6.846101e-01
5       przew   3.061503e-05
6          ph   1.814063e-01
7       namon   1.242766e-06
8         ITS   1.198570e-01</code></pre>
</div>
</div>
</section>
<section id="wspólne-wnioski-z-testów-normalności-dla-zmiennych" class="level3">
<h3 class="anchored" data-anchor-id="wspólne-wnioski-z-testów-normalności-dla-zmiennych">5.6 Wspólne wnioski z testów normalności dla zmiennych</h3>
<ol type="1">
<li><p><strong>Ogólna zgodność wyników</strong><br>
Wyniki różnych testów normalności (Shapiro-Wilka, Kołmogorowa-Smirnowa, Andersona-Darlinga i Lilleforsa) wykazują podobne tendencje, chociaż ich dokładność różni się w zależności od próbki i czułości testu na różne aspekty rozkładu danych.</p></li>
<li><p><strong>Zmienna o rozkładzie najbliższym normalnemu</strong></p>
<ul>
<li><p>Zmienna <strong>temp</strong> wykazuje spójne wysokie wartości p we wszystkich testach, co wskazuje, że może być zgodna z rozkładem normalnym.</p></li>
<li><p>Podobnie zmienne <strong>ph</strong>, <strong>nas</strong>, i <strong>ITS</strong> mają w większości testów wysokie p-value, co sugeruje zgodność z normalnością lub niewielkie odstępstwa.</p></li>
</ul></li>
<li><p><strong>Zmienna z największymi odstępstwami od normalności</strong></p>
<ul>
<li><p>Zmienna <strong>przew</strong> jest konsekwentnie wskazywana jako <strong>niezgodna z rozkładem normalnym</strong> przez wszystkie testy, z wyjątkowo niskimi wartościami p.</p></li>
<li><p>Podobne odstępstwa dotyczą zmiennych <strong>chla</strong>, <strong>bar</strong>, i <strong>namon</strong>, które również regularnie wykazują <strong>statystycznie istotne różnice względem normalności</strong>.</p></li>
</ul></li>
<li><p><strong>Kurtoza</strong></p>
<ul>
<li><p>Zmienna <strong>przew</strong> ma bardzo wysoką wartość kurtozy (8.24), co wskazuje na obecność dużej liczby ekstremalnych wartości.</p></li>
<li><p>Wysoka kurtoza zmiennej <strong>chla</strong> również potwierdza odstępstwa od normalności.</p></li>
</ul></li>
<li><p><strong>Uwagi o spójności między testami</strong></p>
<ul>
<li><p>Testy Shapiro-Wilka, Andersona-Darlinga i Lilleforsa są bardziej czułe na końce rozkładu niż test Kołmogorowa-Smirnowa, co tłumaczy niższe wartości p dla zmiennych z ekstremami w rozkładzie.</p></li>
<li><p>Dla zmiennej <strong>ITS</strong>, wartości p sugerują, że jest ona <strong>najbliższa normalności</strong> spośród nowych zmiennych wprowadzonych do analizy, ale nie jest to jednoznaczne we wszystkich testach.</p></li>
</ul></li>
</ol>
</section>
<section id="podsumowanie-i-rekomendacje" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie-i-rekomendacje">Podsumowanie i rekomendacje</h3>
<ol type="1">
<li><p><strong>Zastosowanie metod parametrycznych</strong> jest uzasadnione jedynie dla zmiennych <strong>temp</strong>, <strong>ph</strong>, <strong>nas</strong>, i <strong>ITS</strong>, które nie odrzuciły hipotezy o normalności rozkładu.</p></li>
<li><p><strong>Zmienna przew</strong> i inne zmienne odbiegające od normalności (szczególnie <strong>chla</strong>, <strong>bar</strong>, i <strong>namon</strong>) wymagają stosowania <strong>metod nieparametrycznych</strong> w dalszej analizie.</p></li>
<li><p>Przy interpretacji wyników analizy dla zmiennych o wysoce nienormalnych rozkładach należy brać pod uwagę wpływ wartości skrajnych, zwłaszcza w przypadku zmiennej <strong>przew</strong>.</p></li>
</ol>
</section>
</section>
<section id="testy-odstające" class="level2">
<h2 class="anchored" data-anchor-id="testy-odstające">6. Testy odstające</h2>
<section id="grubbs" class="level3">
<h3 class="anchored" data-anchor-id="grubbs">6.1 Grubbs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dla 2 najwyższych</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(its_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Grubbs test for one outlier

data:  its_values
G = 1.83175, U = 0.93155, p-value = 1
alternative hypothesis: highest value 8.94523 is an outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(its_values[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Grubbs test for one outlier

data:  its_values[1:50]
G = 1.91102, U = 0.92395, p-value = 1
alternative hypothesis: highest value 8.94338 is an outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dla 2 najniższych</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(its_values, <span class="at">opposite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Grubbs test for one outlier

data:  its_values
G = 1.81050, U = 0.93313, p-value = 1
alternative hypothesis: lowest value 7.64986 is an outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(its_values[<span class="dv">2</span><span class="sc">:</span><span class="dv">51</span>], <span class="at">opposite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Grubbs test for one outlier

data:  its_values[2:51]
G = 1.64961, U = 0.94333, p-value = 1
alternative hypothesis: lowest value 7.73416 is an outlier</code></pre>
</div>
</div>
</section>
<section id="dixon" class="level3">
<h3 class="anchored" data-anchor-id="dixon">6.2 Dixon</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dla 2 najwyższych</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dixon.test</span>(its_values[<span class="dv">22</span><span class="sc">:</span><span class="dv">51</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Dixon test for outliers

data:  its_values[22:51]
Q = 0.063706, p-value = 0.1829
alternative hypothesis: highest value 8.94523 is an outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dixon.test</span>(its_values[<span class="dv">22</span><span class="sc">:</span><span class="dv">50</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Dixon test for outliers

data:  its_values[22:50]
Q = 0.098416, p-value = 0.3892
alternative hypothesis: highest value 8.94338 is an outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dla 2 najniższych</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dixon.test</span>(its_values[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Dixon test for outliers

data:  its_values[1:30]
Q = 0.1525, p-value = 0.7963
alternative hypothesis: lowest value 7.64986 is an outlier</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dixon.test</span>(its_values[<span class="dv">2</span><span class="sc">:</span><span class="dv">30</span>], <span class="at">opposite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Dixon test for outliers

data:  its_values[2:30]
Q = 0.065688, p-value = 0.1883
alternative hypothesis: lowest value 7.73416 is an outlier</code></pre>
</div>
</div>
</section>
<section id="rosner" class="level3">
<h3 class="anchored" data-anchor-id="rosner">6.3 Rosner</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dla 2 najwyższych</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rosnerTest</span>(its_values, <span class="at">k =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Results of Outlier Test
-------------------------

Test Method:                     Rosner's Test for Outliers

Hypothesized Distribution:       Normal

Data:                            its_values

Sample Size:                     51

Test Statistics:                 R.1 = 1.831754
                                 R.2 = 1.911024

Test Statistic Parameter:        k = 2

Alternative Hypothesis:          Up to 2 observations are not
                                 from the same Distribution.

Type I Error:                    5%

Number of Outliers Detected:     0

  i   Mean.i      SD.i   Value Obs.Num    R.i+1 lambda.i+1 Outlier
1 0 8.293766 0.3556504 8.94523      51 1.831754   3.136165   FALSE
2 1 8.280737 0.3467478 8.94338      50 1.911024   3.128247   FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dla 2 najniższych</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rosnerTest</span>(its_values[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>], <span class="at">k =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Results of Outlier Test
-------------------------

Test Method:                     Rosner's Test for Outliers

Hypothesized Distribution:       Normal

Data:                            its_values[1:30]

Sample Size:                     30

Test Statistic:                  R.1 = 1.906009

Test Statistic Parameter:        k = 1

Alternative Hypothesis:          Up to 1 observations are not
                                 from the same Distribution.

Type I Error:                    5%

Number of Outliers Detected:     0

  i  Mean.i      SD.i   Value Obs.Num    R.i+1 lambda.i+1 Outlier
1 0 8.04606 0.2078691 7.64986       1 1.906009   2.908473   FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rosnerTest</span>(its_values[<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">k =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Results of Outlier Test
-------------------------

Test Method:                     Rosner's Test for Outliers

Hypothesized Distribution:       Normal

Data:                            its_values[2:10]

Sample Size:                     9

Test Statistic:                  R.1 = 1.329997

Test Statistic Parameter:        k = 1

Alternative Hypothesis:          Up to 1 observations are not
                                 from the same Distribution.

Type I Error:                    5%

Number of Outliers Detected:     0

  i   Mean.i       SD.i   Value Obs.Num    R.i+1 lambda.i+1 Outlier
1 0 7.850353 0.08736359 7.73416       1 1.329997   2.215004   FALSE</code></pre>
</div>
</div>
</section>
<section id="wnioski-z-testów-grubbsa-dixona-i-rosnera-dla-wartości-its" class="level3">
<h3 class="anchored" data-anchor-id="wnioski-z-testów-grubbsa-dixona-i-rosnera-dla-wartości-its">6.4 Wnioski z testów Grubbsa, Dixona i Rosnera dla wartości ITS</h3>
<ol type="1">
<li><p><strong>Brak istotnych wartości odstających</strong><br>
Wszystkie testy (Grubbsa, Dixona i Rosnera) wskazują brak statystycznie istotnych wartości odstających w zestawie danych ITS, niezależnie od próbkowania (pełny zbiór danych lub jego podzbiory). Wszystkie wartości p są większe niż typowy poziom istotności 0,05, co oznacza, że nie ma podstaw do odrzucenia hipotezy zerowej o braku odstających obserwacji. W takim wypadku również nie bierzemy pod uwagę hipotezy alternatywnej, wg której 2 największe i 2 najmniejsze wartości są odstające.</p></li>
<li><p><strong>Różnice w testach</strong></p>
<ul>
<li><p><strong>Test Grubbsa</strong> sprawdza pojedyncze najniższe lub najwyższe wartości jako potencjalne outliery. We wszystkich przypadkach wartość p wynosi 1, co jednoznacznie wskazuje brak wartości odstających.</p></li>
<li><p><strong>Test Dixona</strong> również nie wykazuje obecności wartości odstających, choć jego wartości p są niższe niż w teście Grubbsa, ale nadal nieosiągające poziomu istotności.</p></li>
<li><p><strong>Test Rosnera</strong> dla różnych prób ITS potwierdza brak odchyleń od rozkładu normalnego, wskazując, że nie znaleziono żadnych odstających punktów przy założonym poziomie istotności (5%).</p></li>
</ul></li>
<li><p><strong>Wynik globalny dla danych ITS</strong><br>
Dane ITS są wolne od wartości odstających, co sugeruje, że rozkład danych jest stabilny i nie wymaga specjalnego traktowania wartości skrajnych w dalszej analizie statystycznej.</p></li>
</ol>
</section>
<section id="rekomendacje" class="level3">
<h3 class="anchored" data-anchor-id="rekomendacje">Rekomendacje</h3>
<ul>
<li><p><strong>Brak konieczności usuwania obserwacji</strong>: Wszystkie dane mogą być bezpiecznie używane w analizach bez potrzeby eliminacji punktów jako wartości odstające.</p></li>
<li><p><strong>Zastosowanie metod parametrycznych</strong> dla ITS może być odpowiednie, jeżeli dodatkowe testy potwierdzą normalność rozkładu (zgodnie z wcześniejszymi analizami normalności).</p></li>
</ul>
</section>
</section>
<section id="regresja-liniowa" class="level2">
<h2 class="anchored" data-anchor-id="regresja-liniowa">7. Regresja liniowa</h2>
<section id="model-regresji-liniowej" class="level3">
<h3 class="anchored" data-anchor-id="model-regresji-liniowej">7.1 Model regresji liniowej</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(ITS <span class="sc">~</span> nas <span class="sc">+</span> ph <span class="sc">+</span> przew <span class="sc">+</span> namon <span class="sc">+</span> temp <span class="sc">+</span> bar, <span class="at">data =</span> dane)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>lm_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ITS ~ nas + ph + przew + namon + temp + bar, data = dane)

Coefficients:
(Intercept)          nas           ph        przew        namon         temp  
  1.300e+00   -1.300e-02    1.000e+00    2.842e-18    1.135e-15    3.533e-17  
        bar  
 -2.060e-18  </code></pre>
</div>
</div>
<p><strong>Wnioski:</strong> Największy wpływ zmiennej pH Współczynnik dla zmiennej ph wynosi dokładnie 1.000, co sugeruje, że zmiana wartości pH o 1 jednostkę powoduje proporcjonalną zmianę wartości ITS o 1 jednostkę. Zmienna ta ma więc największy wpływ na wartość ITS w modelu.</p>
<p><strong>Negatywny wpływ zmiennej nas:</strong> Zmienna nas ma ujemny współczynnik -0.013, co oznacza, że zwiększenie nas o 1 jednostkę prowadzi do spadku ITS o 0.013 jednostki, zgodnie z formułą definicji ITS, w której nas jest odejmowane.</p>
<p><strong>Minimalny wpływ innych zmiennych:</strong> Współczynniki dla pozostałych zmiennych (przew, namon, temp, bar) są bardzo bliskie zera i ich wpływ na zmienną zależną ITS można uznać za znikomy lub statystycznie nieistotny. Mogą one być niepotrzebne w modelu, jeśli analiza statystyczna potwierdzi brak istotności.</p>
<p><strong>Stała (intercept):</strong> Wartość stałej wynosi 1.300, co oznacza, że gdy wszystkie zmienne niezależne mają wartość zero, ITS wynosi 1.300. Jednak fizyczna interpretacja tej wartości w kontekście rzeczywistych danych może być ograniczona, w zależności od zakresu zmiennych.</p>
</section>
<section id="statystyki-modelu" class="level3">
<h3 class="anchored" data-anchor-id="statystyki-modelu">7.2 Statystyki modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(lm_model): idealne dopasowanie: podsumowanie może nie być
wiarygodne</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ITS ~ nas + ph + przew + namon + temp + bar, data = dane)

Residuals:
       Min         1Q     Median         3Q        Max 
-6.418e-15 -3.906e-16  2.636e-16  4.522e-16  1.067e-15 

Coefficients:
              Estimate Std. Error    t value Pr(&gt;|t|)    
(Intercept)  1.300e+00  3.520e-15  3.693e+14   &lt;2e-16 ***
nas         -1.300e-02  2.159e-17 -6.022e+14   &lt;2e-16 ***
ph           1.000e+00  6.538e-16  1.530e+15   &lt;2e-16 ***
przew        2.842e-18  4.024e-18  7.060e-01    0.484    
namon        1.135e-15  2.701e-15  4.200e-01    0.676    
temp         3.533e-17  5.062e-17  6.980e-01    0.489    
bar         -2.060e-18  1.637e-17 -1.260e-01    0.900    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.117e-15 on 44 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:      1 
F-statistic: 8.441e+29 on 6 and 44 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="wyniki-testu-współliniowości-vif" class="level3">
<h3 class="anchored" data-anchor-id="wyniki-testu-współliniowości-vif">7.3 Wyniki testu współliniowości (VIF):**</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(object, ...): idealne dopasowanie: podsumowanie może nie
być wiarygodne</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     nas       ph    przew    namon     temp      bar 
4.292308 4.344063 1.311860 1.175271 1.177054 1.033949 </code></pre>
</div>
</div>
<p><strong>Brak krytycznej współliniowości:</strong></p>
<p>Typowo wartość VIF &gt; 10 sugeruje poważne problemy współliniowości. W tym przypadku wszystkie zmienne mają wartości VIF znacznie poniżej 10, co wskazuje, że problem współliniowości jest niewielki lub nie istnieje w tym modelu. Największe wartości VIF dla zmiennych ph i nas:</p>
<p>Zmienne ph (4.34) i nas (4.29) mają najwyższe wartości VIF, co może sugerować pewną zależność między nimi a innymi zmiennymi predyktorowymi. Nie jest to jednak na tyle poważne, aby wymagać natychmiastowego usunięcia tych zmiennych. Idealne dopasowanie i inne możliwe przyczyny:</p>
<p>Pomimo niskich wartości VIF, ostrzeżenie o idealnym dopasowaniu wskazuje, że może istnieć problem z konstrukcją modelu. Jest możliwe, że związek zmiennej zależnej ITS z predyktorami został sztucznie wyrażony w danych (np. przez formułę obliczenia ITS jako funkcji ph i nas), co prowadzi do braku resztowej wariancji.</p>
</section>
<section id="wykresy-reszt" class="level3">
<h3 class="anchored" data-anchor-id="wykresy-reszt">7.4 Wykresy reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretacja-wykresów-diagnostycznych" class="level3">
<h3 class="anchored" data-anchor-id="interpretacja-wykresów-diagnostycznych">7.5 Interpretacja wykresów diagnostycznych:</h3>
<section id="residuals-vs-fitted" class="level4">
<h4 class="anchored" data-anchor-id="residuals-vs-fitted">Residuals vs Fitted</h4>
<ul>
<li><p><strong>Cel:</strong> Sprawdzenie liniowości i jednorodności wariancji.</p></li>
<li><p><strong>Interpretacja:</strong> Reszty powinny być losowo rozproszone wokół poziomu 0. Brak wzorca wskazuje, że założenie liniowości i homoskedastyczności (stałej wariancji) jest spełnione. Na podstawie Twojego wykresu, rozproszenie reszt wygląda na dość równomierne, co jest pozytywnym znakiem.</p></li>
</ul>
</section>
<section id="q-q-plot-quantile-quantile-plot" class="level4">
<h4 class="anchored" data-anchor-id="q-q-plot-quantile-quantile-plot">Q-Q Plot (Quantile-Quantile Plot)</h4>
<ul>
<li><p><strong>Cel</strong>: Sprawdzenie normalności rozkładu reszt.</p></li>
<li><p><strong>Interpretacja:</strong> Punkty powinny leżeć blisko linii prostej. Odchylenia na końcach mogą wskazywać na problemy z normalnością. W Twoim wykresie reszty są zbliżone do linii, co sugeruje, że normalność jest w przybliżeniu spełniona.</p></li>
</ul>
</section>
<section id="scale-location" class="level4">
<h4 class="anchored" data-anchor-id="scale-location">Scale-Location</h4>
<ul>
<li><p><strong>Cel:</strong> Sprawdzenie jednorodności wariancji.</p></li>
<li><p><strong>Interpretacja:</strong> Punkty powinny być losowo rozproszone wokół poziomej linii. Twoje wykresy pokazują równomierne rozproszenie, co sugeruje, że wariancja reszt jest dość jednorodna.</p></li>
</ul>
</section>
<section id="residuals-vs-leverage" class="level4">
<h4 class="anchored" data-anchor-id="residuals-vs-leverage">Residuals vs Leverage</h4>
<ul>
<li><p><strong>Cel:</strong> Identyfikacja punktów o wysokiej dźwigni lub dużym wpływie.</p></li>
<li><p><strong>Interpretacja:</strong> Sprawdzamy, czy są jakieś punkty o dużym wpływie na model (wskazane przez Cook’s distance). Jeśli są, mogą mieć zbyt duży wpływ na model. W Twoim przypadku nie ma znaczących odstających punktów, co sugeruje brak problematycznych obserwacji.</p></li>
</ul>
</section>
</section>
</section>
<section id="przykładowa-predykcja-z-wykorzystaniem-naszego-modelu-regresji" class="level2">
<h2 class="anchored" data-anchor-id="przykładowa-predykcja-z-wykorzystaniem-naszego-modelu-regresji">8. Przykładowa predykcja z wykorzystaniem naszego modelu regresji</h2>
<section id="stworzenie-próbnych-danych" class="level3">
<h3 class="anchored" data-anchor-id="stworzenie-próbnych-danych">8.1 Stworzenie próbnych danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">nas =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">60</span>),  <span class="at">ph =</span> <span class="fu">c</span>(<span class="fl">7.0</span>, <span class="fl">7.5</span>),  <span class="at">przew =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">400</span>),  <span class="at">namon =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>),  <span class="at">temp =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>),  <span class="at">bar =</span> <span class="fu">c</span>(<span class="dv">1010</span>, <span class="dv">1020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predykcja-its" class="level3">
<h3 class="anchored" data-anchor-id="predykcja-its">8.2 Predykcja ITS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>predicted_ITS <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>predicted_ITS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2 
7.65 8.02 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(dane<span class="sc">$</span>ITS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.64986</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(dane<span class="sc">$</span>ITS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.94523</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dane<span class="sc">$</span>ITS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.293766</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dane<span class="sc">$</span>ITS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3556504</code></pre>
</div>
</div>
</section>
<section id="wnioski-predykcji" class="level3">
<h3 class="anchored" data-anchor-id="wnioski-predykcji">Wnioski predykcji:</h3>
<ul>
<li>Przewidywane wartości mieszczą się w zakresie rzeczywistych wartości ITS</li>
<li>7.65 jest równe minimalnej wartości zakresu oraz jest poza odchyleniem standardowym</li>
<li>Model dość dobrze przewiduje wartości ITS</li>
</ul>
</section>
</section>
<section id="model-regresji-wielomianowej" class="level2">
<h2 class="anchored" data-anchor-id="model-regresji-wielomianowej">9. Model regresji wielomianowej</h2>
<section id="dodanie-numeru-wiersza-jako-zmiennej-w-ramce-danych" class="level3">
<h3 class="anchored" data-anchor-id="dodanie-numeru-wiersza-jako-zmiennej-w-ramce-danych">9.1 Dodanie numeru wiersza jako zmiennej w ramce danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>dane<span class="sc">$</span>row_number <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wykres-regresji-liniowej-dla-its" class="level3">
<h3 class="anchored" data-anchor-id="wykres-regresji-liniowej-dla-its">9.2 Wykres regresji liniowej dla ITS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> row_number, <span class="at">y =</span> ITS)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'Rzeczywiste punkty'</span>)) <span class="sc">+</span>  <span class="co"># Użycie aes dla kolorów</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Regresja liniowa"</span>)) <span class="sc">+</span>  <span class="co"># Użycie aes dla kolorów</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Legenda"</span>, </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Rzeczywiste punkty"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Regresja liniowa"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rzeczywiste vs Przewidywane ITS (Model liniowy)"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Numer wiersza"</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ITS"</span>) <span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dopasowanie-modelu-wielomianowego-drugiego-stopnia" class="level3">
<h3 class="anchored" data-anchor-id="dopasowanie-modelu-wielomianowego-drugiego-stopnia">9.3 Dopasowanie modelu wielomianowego drugiego stopnia</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>model_poly <span class="ot">&lt;-</span> <span class="fu">lm</span>(ITS <span class="sc">~</span> <span class="fu">poly</span>(row_number, <span class="dv">2</span>), <span class="at">data =</span> dane)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>model_poly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ITS ~ poly(row_number, 2), data = dane)

Coefficients:
         (Intercept)  poly(row_number, 2)1  poly(row_number, 2)2  
               8.294                 1.341                -0.124  </code></pre>
</div>
</div>
</section>
<section id="przewidywanie-wartości" class="level3">
<h3 class="anchored" data-anchor-id="przewidywanie-wartości">9.4 Przewidywanie wartości</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>dane<span class="sc">$</span>predicted_poly <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_poly, <span class="at">newdata =</span> dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wykres-regresji-wielomianowej-dla-its" class="level3">
<h3 class="anchored" data-anchor-id="wykres-regresji-wielomianowej-dla-its">9.5 Wykres regresji wielomianowej dla ITS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> row_number)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ITS, <span class="at">color =</span> <span class="st">"Rzeczywiste punkty"</span>)) <span class="sc">+</span>  <span class="co"># Rzeczywiste wartości ITS</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted_poly, <span class="at">color =</span> <span class="st">"regresja wielomianowa"</span>)) <span class="sc">+</span>  <span class="co"># Linia regresji</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Legenda"</span>, </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Rzeczywiste punkty"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"regresja wielomianowa"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rzeczywiste vs Przewidywane ITS (Model Wielomianowy)"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Numer wiersza"</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ITS"</span>) <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)  <span class="co"># Ustawienie pozycji legendy na prawo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-regresji-liniowej-dla-its-i-chla" class="level3">
<h3 class="anchored" data-anchor-id="model-regresji-liniowej-dla-its-i-chla">9.6 Model regresji liniowej dla ITS i Chla</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#regresja w zależności od zmiennej chla</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> chla, <span class="at">y =</span> ITS)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'Rzeczywiste punkty'</span>)) <span class="sc">+</span>  <span class="co"># Rzeczywiste wartości ITS</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Regresja liniowa"</span>)) <span class="sc">+</span>  <span class="co"># Linia regresji</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Legenda"</span>, </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Rzeczywiste punkty"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Regresja liniowa"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zależność ITS od Chla (Model liniowy)"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Chla"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ITS"</span>) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-regresji-wielomianowej-dla-its-i-chla" class="level3">
<h3 class="anchored" data-anchor-id="model-regresji-wielomianowej-dla-its-i-chla">9.7 Model regresji wielomianowej dla ITS i Chla</h3>
<p>#Dopasowanie modelu wielomianowego drugiego stopnia dla zmiennej Chla</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>model_poly_chla <span class="ot">&lt;-</span> <span class="fu">lm</span>(ITS <span class="sc">~</span> <span class="fu">poly</span>(chla, <span class="dv">2</span>), <span class="at">data =</span> dane)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Przewidywanie wartości na podstawie modelu wielomianowego</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>dane<span class="sc">$</span>predicted_poly_chla <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_poly_chla, <span class="at">newdata =</span> dane)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Tworzenie wykresu z legendą</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> chla)) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ITS, <span class="at">color =</span> <span class="st">"Rzeczywiste punkty"</span>)) <span class="sc">+</span>  <span class="co"># Rzeczywiste wartości ITS</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted_poly_chla, <span class="at">color =</span> <span class="st">"Regresja wielomianowa"</span>)) <span class="sc">+</span>  <span class="co"># Linia regresji wielomianowej</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Legenda"</span>, </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Rzeczywiste punkty"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Regresja wielomianowa"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zależność ITS od Chla (Model Wielomianowy)"</span>,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Chla"</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ITS"</span>) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)  <span class="co"># Ustawienie pozycji legendy na prawo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="optymalizacja-modelu-dla-its" class="level2">
<h2 class="anchored" data-anchor-id="optymalizacja-modelu-dla-its">10. Optymalizacja modelu dla ITS</h2>
<section id="kryterium-informacyjne-akaikego-aic." class="level3">
<h3 class="anchored" data-anchor-id="kryterium-informacyjne-akaikego-aic.">10.1 Kryterium Informacyjne Akaikego (AIC).</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>mi2<span class="ot">=</span><span class="fu">stepAIC</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-3505.16
ITS ~ nas + ph + przew + namon + temp + bar</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: próba wyboru modelu dla idealnego dopasowania jest bez sensu</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Df Sum of Sq     RSS     AIC
- bar    1   0.00000 0.00000 -3507.1
- namon  1   0.00000 0.00000 -3507.0
- temp   1   0.00000 0.00000 -3506.6
- przew  1   0.00000 0.00000 -3506.6
&lt;none&gt;               0.00000 -3505.2
- nas    1   0.45288 0.45288  -228.9
- ph     1   2.92158 2.92158  -133.8

Step:  AIC=-3507.14
ITS ~ nas + ph + przew + namon + temp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: próba wyboru modelu dla idealnego dopasowania jest bez sensu</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Df Sum of Sq    RSS     AIC
- namon  1    0.0000 0.0000 -3508.9
- temp   1    0.0000 0.0000 -3508.6
- przew  1    0.0000 0.0000 -3508.6
&lt;none&gt;               0.0000 -3507.1
- nas    1    0.4536 0.4536  -230.8
- ph     1    2.9235 2.9235  -135.8

Step:  AIC=-3508.94
ITS ~ nas + ph + przew + temp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: próba wyboru modelu dla idealnego dopasowania jest bez sensu</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Df Sum of Sq    RSS     AIC
- temp   1    0.0000 0.0000 -3510.3
- przew  1    0.0000 0.0000 -3510.1
&lt;none&gt;               0.0000 -3508.9
- nas    1    0.4874 0.4874  -229.2
- ph     1    3.2407 3.2407  -132.6

Step:  AIC=-3510.28
ITS ~ nas + ph + przew</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: próba wyboru modelu dla idealnego dopasowania jest bez sensu</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Df Sum of Sq    RSS     AIC
- przew  1    0.0000 0.0000 -3511.4
&lt;none&gt;               0.0000 -3510.3
- nas    1    0.4919 0.4919  -230.7
- ph     1    3.4557 3.4557  -131.3

Step:  AIC=-3511.4
ITS ~ nas + ph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: próba wyboru modelu dla idealnego dopasowania jest bez sensu</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df Sum of Sq    RSS     AIC
&lt;none&gt;              0.0000 -3511.4
- nas   1    0.5833 0.5833  -224.0
- ph    1    3.8082 3.8082  -128.3</code></pre>
</div>
</div>
<ul>
<li>AIC spada (np. z -3505.16 do -3511.4), co wskazuje na poprawę modelu przy redukcji zmiennych.</li>
<li>Przy idealnym dopasowaniu (RSS = 0) znaczenie AIC staje się mniej istotne, ponieważ nie odzwierciedla ono realnej zdolności modelu do generalizacji.</li>
</ul>
</section>
<section id="kombninacje-zmiennych" class="level3">
<h3 class="anchored" data-anchor-id="kombninacje-zmiennych">10.2 Kombninacje zmiennych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>mi3<span class="ot">=</span><span class="fu">regsubsets</span>(ITS<span class="sc">~</span>.,<span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],<span class="at">nbest=</span><span class="dv">5</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi3,<span class="at">scale=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Czarne bloki wskazują na obecność danej zmiennej w danym modelu.</li>
<li>Zmienne, takie jak nas i ph pojawiają się w wielu modelach, co sugeruje ich istotny wpływ na zmienną zależną ITS.</li>
<li>Niektóre zmienne (np. chla, temp, bar) są mniej istotne, ponieważ pojawiają się w mniejszej liczbie modeli.</li>
</ul>
</section>
<section id="drzewo-decyzyjne" class="level3">
<h3 class="anchored" data-anchor-id="drzewo-decyzyjne">10.3 Drzewo decyzyjne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>mi4 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(ITS<span class="sc">~</span>.,<span class="at">data=</span>dane[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.rpart) </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(mi4, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Zmienna ph jest kluczowym czynnikiem wpływającym na wartość ITS.</li>
<li>Wartość ITS wzrasta wraz z wyższymi wartościami ph</li>
<li>Najniższe wartości ITS (7.86) występują dla ph &lt; 7.85.</li>
<li>Najwyższe wartości ITS (8.84) pojawiają się, gdy ph &gt;= 8.79</li>
</ul>
</section>
<section id="model-caret---rpart" class="level3">
<h3 class="anchored" data-anchor-id="model-caret---rpart">10.4 Model caret - rpart</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Control_its <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">verboseIter =</span> T)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Wersja pierwsza pruning późny - rpart</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>mi5 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(ITS<span class="sc">~</span>.,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric =</span> <span class="st">'MAE'</span>, <span class="co"># RMSE</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trControl =</span> Control_its,</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.action =</span> na.rpart,</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tuneLength =</span> <span class="dv">15</span> <span class="co"># random search, ale po jednym czynniku</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold01: cp=0 
- Fold01: cp=0 
+ Fold02: cp=0 
- Fold02: cp=0 
+ Fold03: cp=0 
- Fold03: cp=0 
+ Fold04: cp=0 
- Fold04: cp=0 
+ Fold05: cp=0 
- Fold05: cp=0 
+ Fold06: cp=0 
- Fold06: cp=0 
+ Fold07: cp=0 
- Fold07: cp=0 
+ Fold08: cp=0 
- Fold08: cp=0 
+ Fold09: cp=0 
- Fold09: cp=0 
+ Fold10: cp=0 
- Fold10: cp=0 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,
: There were missing values in resampled performance measures.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Aggregating results
Selecting tuning parameters
Fitting cp = 0 on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyniki:</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>mi5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

51 samples
 7 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 45, 46, 47, 46, 46, 46, ... 
Resampling results across tuning parameters:

  cp         RMSE       Rsquared   MAE       
  0.0000000  0.1092382  0.9469444  0.09516411
  0.0552304  0.1358252  0.8984654  0.11013001
  0.1104608  0.1669523  0.8219994  0.13948402
  0.1656912  0.1684196  0.8228150  0.14029868
  0.2209216  0.1684196  0.8228150  0.14029868
  0.2761520  0.1684196  0.8228150  0.14029868
  0.3313824  0.1684196  0.8228150  0.14029868
  0.3866128  0.1684196  0.8228150  0.14029868
  0.4418432  0.1684196  0.8228150  0.14029868
  0.4970736  0.1684196  0.8228150  0.14029868
  0.5523040  0.1684196  0.8228150  0.14029868
  0.6075344  0.1684196  0.8228150  0.14029868
  0.6627648  0.1684196  0.8228150  0.14029868
  0.7179952  0.1684196  0.8228150  0.14029868
  0.7732256  0.2530705  0.7985193  0.22119956

MAE was used to select the optimal model using the smallest value.
The final value used for the model was cp = 0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CP - parametr złożoności modelu</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co">#MAE - średni błąd bezwzględny (większy -&gt; model mniej dokładny)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Model z parametrem cp = 0 daje najlepsze wyniki, z bardzo niskim błędem MAE i wysokim R², co oznacza, że dobrze odwzorowuje zależności w danych.</li>
<li>Zwiększanie wartości cp prowadzi do zbyt mocnego przycinania drzewa, co powoduje spadek dokładności modelu (zwiększenie MAE, spadek R²)</li>
<li>Od cp ok. 0.72 MAE zaczyna gwałtownie rosnąć</li>
</ul>
</section>
<section id="model-caret---bagearth" class="level3">
<h3 class="anchored" data-anchor-id="model-caret---bagearth">10.5 Model caret - bagEarth</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>Control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">verboseIter =</span> T)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>mi7 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(ITS<span class="sc">~</span>.,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data=</span>dane[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">method =</span> <span class="st">"bagEarth"</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">metric =</span> <span class="st">'MAE'</span>, </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">trControl =</span> Control,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">na.action =</span> na.omit,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">tuneLength =</span> <span class="dv">15</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold01: degree=1, nprune=5 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Ładowanie wymaganego pakietu: earth</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: pakiet 'earth' został zbudowany w wersji R 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Ładowanie wymaganego pakietu: Formula</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Ładowanie wymaganego pakietu: plotmo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: pakiet 'plotmo' został zbudowany w wersji R 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>- Fold01: degree=1, nprune=5 
+ Fold02: degree=1, nprune=5 
- Fold02: degree=1, nprune=5 
+ Fold03: degree=1, nprune=5 
- Fold03: degree=1, nprune=5 
+ Fold04: degree=1, nprune=5 
- Fold04: degree=1, nprune=5 
+ Fold05: degree=1, nprune=5 
- Fold05: degree=1, nprune=5 
+ Fold06: degree=1, nprune=5 
- Fold06: degree=1, nprune=5 
+ Fold07: degree=1, nprune=5 
- Fold07: degree=1, nprune=5 
+ Fold08: degree=1, nprune=5 
- Fold08: degree=1, nprune=5 
+ Fold09: degree=1, nprune=5 
- Fold09: degree=1, nprune=5 
+ Fold10: degree=1, nprune=5 
- Fold10: degree=1, nprune=5 
Aggregating results
Selecting tuning parameters
Fitting nprune = 5, degree = 1 on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#terms -  złożoność modelu w kontekście liczby zmiennych uwzględnionych w modelu.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>MAE spada wraz ze wzrostem liczby zmiennych, osiągając stabilizację przy #Terms = 4.</li>
<li>Dodanie większej liczby zmiennych (przy #Terms &gt; 4) nie poprawia dokładności modelu, co może oznaczać wystarczające dopasowanie już dla 4 Terms</li>
<li>Wartość MAE spada wraz z pierwszymi dodanymi zmiennymi, co sugeruje, że kluczowe cechy danych są dobrze uchwycone przez model</li>
</ul>
</section>
<section id="model-caret---glmboot" class="level3">
<h3 class="anchored" data-anchor-id="model-caret---glmboot">10.6 Model caret - glmboot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>mi8 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(ITS<span class="sc">~</span>.,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">method =</span> <span class="st">"glmboost"</span>,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">metric =</span> <span class="st">'MAE'</span>, </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">trControl =</span> Control,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.action =</span> na.omit,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">tuneLength =</span> <span class="dv">15</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold01: mstop=750, prune=no 
- Fold01: mstop=750, prune=no 
+ Fold02: mstop=750, prune=no 
- Fold02: mstop=750, prune=no 
+ Fold03: mstop=750, prune=no 
- Fold03: mstop=750, prune=no 
+ Fold04: mstop=750, prune=no 
- Fold04: mstop=750, prune=no 
+ Fold05: mstop=750, prune=no 
- Fold05: mstop=750, prune=no 
+ Fold06: mstop=750, prune=no 
- Fold06: mstop=750, prune=no 
+ Fold07: mstop=750, prune=no 
- Fold07: mstop=750, prune=no 
+ Fold08: mstop=750, prune=no 
- Fold08: mstop=750, prune=no 
+ Fold09: mstop=750, prune=no 
- Fold09: mstop=750, prune=no 
+ Fold10: mstop=750, prune=no 
- Fold10: mstop=750, prune=no 
Aggregating results
Selecting tuning parameters
Fitting mstop = 750, prune = no on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>mi8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Boosted Generalized Linear Model 

51 samples
 7 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 45, 45, 46, 46, 46, 46, ... 
Resampling results across tuning parameters:

  mstop  RMSE         Rsquared   MAE        
   50    0.092198069  0.9552745  0.073953831
  100    0.062744082  0.9800145  0.050063151
  150    0.043380687  0.9901778  0.034447248
  200    0.031185786  0.9945668  0.024432441
  250    0.023542432  0.9965748  0.017978676
  300    0.018174912  0.9977955  0.013656419
  350    0.014055520  0.9986136  0.010485161
  400    0.010937878  0.9991118  0.008110810
  450    0.008601694  0.9994109  0.006318181
  500    0.006752931  0.9996092  0.004970311
  550    0.005401602  0.9997301  0.003960428
  600    0.004314796  0.9998148  0.003183948
  650    0.003501539  0.9998691  0.002574188
  700    0.002860747  0.9999069  0.002089258
  750    0.002381077  0.9999323  0.001726138

Tuning parameter 'prune' was held constant at a value of no
MAE was used to select the optimal model using the smallest value.
The final values used for the model were mstop = 750 and prune = no.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(mi8)<span class="sc">~</span>dane<span class="sc">$</span>ITS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>MAE sukcesywnie maleje wraz ze wzrostem liczby iteracji</p></li>
<li><p>Wartość MAE stabilizuje się przy około 700 iteracjach na poziomie około 0.0047, co oznacza bardzo niski błąd predykcji</p></li>
<li><p>Punkty są bardzo blisko linii prostej (diagonali), co wskazuje na bardzo dobre dopasowanie modelu</p></li>
<li><p>Nie widać wyraźnych odstępstw, co sugeruje, że model dobrze odwzorowuje rzeczywiste dane</p></li>
</ul>
</section>
</section>
<section id="optymalizacja-modelu-dla-chla" class="level2">
<h2 class="anchored" data-anchor-id="optymalizacja-modelu-dla-chla">11 Optymalizacja modelu dla chla</h2>
<section id="kombninacje-zmiennych-1" class="level3">
<h3 class="anchored" data-anchor-id="kombninacje-zmiennych-1">11.1 Kombninacje zmiennych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>mi3_ch<span class="ot">=</span><span class="fu">regsubsets</span>(chla<span class="sc">~</span>.,<span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],<span class="at">nbest=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax, force.in =
force.in, : 1 linear dependencies found</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax, force.in =
force.in, : nvmax reduced to 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi3_ch,<span class="at">scale=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Zmienne, takie jak namon, nas i ph pojawiają się w wielu modelach, co sugeruje ich istotny wpływ na zmienną chla.</li>
</ul>
</section>
<section id="drzewo-decyzyjne-1" class="level3">
<h3 class="anchored" data-anchor-id="drzewo-decyzyjne-1">11.2 Drzewo decyzyjne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>mi4_ch <span class="ot">&lt;-</span> <span class="fu">rpart</span>(chla<span class="sc">~</span>.,<span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">na.action =</span> na.rpart) </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(mi4_ch, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>nas to kluczowa zmienna decyzyjna. Jeśli nas &gt;= 103, wartość chla jest znacznie wyższa (średnia 37.7) w porównaniu z przypadkiem, gdy nas &lt; 103 (średnia 12.3).</li>
<li>Zmienna chla jest wyższa dla większych wartości nas i ph</li>
<li>Największa część próbek (62.7%) znajduje się w węźle z warunkiem nas &lt; 103 i ph &lt; 8.3.</li>
</ul>
</section>
<section id="model-caret---rpart-1" class="level3">
<h3 class="anchored" data-anchor-id="model-caret---rpart-1">11.3 Model caret - rpart</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>mi5_ch <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(chla<span class="sc">~</span>.,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric =</span> <span class="st">'MAE'</span>, <span class="co"># RMSE</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trControl =</span> Control_its,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.action =</span> na.rpart,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tuneLength =</span> <span class="dv">15</span> </span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold01: cp=0 
- Fold01: cp=0 
+ Fold02: cp=0 
- Fold02: cp=0 
+ Fold03: cp=0 
- Fold03: cp=0 
+ Fold04: cp=0 
- Fold04: cp=0 
+ Fold05: cp=0 
- Fold05: cp=0 
+ Fold06: cp=0 
- Fold06: cp=0 
+ Fold07: cp=0 
- Fold07: cp=0 
+ Fold08: cp=0 
- Fold08: cp=0 
+ Fold09: cp=0 
- Fold09: cp=0 
+ Fold10: cp=0 
- Fold10: cp=0 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,
: There were missing values in resampled performance measures.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Aggregating results
Selecting tuning parameters
Fitting cp = 0 on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyniki:</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>mi5_ch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

51 samples
 7 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 46, 47, 45, 45, 45, 47, ... 
Resampling results across tuning parameters:

  cp          RMSE      Rsquared   MAE     
  0.00000000  17.90095  0.4117144  13.96498
  0.02652289  18.18059  0.3972641  14.36649
  0.05304578  18.81722  0.3532055  15.24788
  0.07956867  18.81722  0.3532055  15.24788
  0.10609156  18.81722  0.3532055  15.24788
  0.13261445  18.46659  0.3429576  15.13872
  0.15913734  18.46659  0.3429576  15.13872
  0.18566023  17.80903  0.3429576  14.59247
  0.21218312  17.80903  0.3429576  14.59247
  0.23870601  17.80903  0.3429576  14.59247
  0.26522890  17.80903  0.3429576  14.59247
  0.29175179  17.80903  0.3429576  14.59247
  0.31827468  17.80903  0.3429576  14.59247
  0.34479757  17.80903  0.3429576  14.59247
  0.37132046  19.72510  0.2346610  15.69978

MAE was used to select the optimal model using the smallest value.
The final value used for the model was cp = 0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi5_ch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Dla wartości cp &gt; 0.3 zauważalny jest wzrost zarówno RMSE, jak i MAE</li>
<li>Najlepsze wyniki model uzyskuje dla cp = 0.0000 do cp = 0.1326, gdzie błędy są najniższe, a dopasowanie (R²) najwyższe</li>
</ul>
</section>
<section id="model-11.4-model-caret---bagearth" class="level3">
<h3 class="anchored" data-anchor-id="model-11.4-model-caret---bagearth">Model 11.4 Model caret - bagEarth</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>Control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">verboseIter =</span> T)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>mi7_ch <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(chla<span class="sc">~</span>.,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data=</span>dane[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">method =</span> <span class="st">"bagEarth"</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">metric =</span> <span class="st">'MAE'</span>, </span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">trControl =</span> Control,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">na.action =</span> na.omit,</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">tuneLength =</span> <span class="dv">15</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold01: degree=1, nprune=14 
- Fold01: degree=1, nprune=14 
+ Fold02: degree=1, nprune=14 
- Fold02: degree=1, nprune=14 
+ Fold03: degree=1, nprune=14 
- Fold03: degree=1, nprune=14 
+ Fold04: degree=1, nprune=14 
- Fold04: degree=1, nprune=14 
+ Fold05: degree=1, nprune=14 
- Fold05: degree=1, nprune=14 
+ Fold06: degree=1, nprune=14 
- Fold06: degree=1, nprune=14 
+ Fold07: degree=1, nprune=14 
- Fold07: degree=1, nprune=14 
+ Fold08: degree=1, nprune=14 
- Fold08: degree=1, nprune=14 
+ Fold09: degree=1, nprune=14 
- Fold09: degree=1, nprune=14 
+ Fold10: degree=1, nprune=14 
- Fold10: degree=1, nprune=14 
Aggregating results
Selecting tuning parameters
Fitting nprune = 8, degree = 1 on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi7_ch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Dla większej liczby terminów (#Terms &gt; 6), MAE staje się mniej stabilne, co wskazuje na potencjalne nadmierne dopasowanie modelu</li>
<li>Najlepszy model uzyskano dla około 6 terminów, gdzie MAE osiągnęło minimum</li>
</ul>
</section>
<section id="model-caret---glmboost" class="level3">
<h3 class="anchored" data-anchor-id="model-caret---glmboost">11.5 Model caret - glmboost</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>mi8_ch <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(chla<span class="sc">~</span>.,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data=</span>dane[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">method =</span> <span class="st">"glmboost"</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">metric =</span> <span class="st">'MAE'</span>, </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">trControl =</span> Control,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.action =</span> na.omit,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">tuneLength =</span> <span class="dv">15</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold01: mstop=750, prune=no 
- Fold01: mstop=750, prune=no 
+ Fold02: mstop=750, prune=no 
- Fold02: mstop=750, prune=no 
+ Fold03: mstop=750, prune=no 
- Fold03: mstop=750, prune=no 
+ Fold04: mstop=750, prune=no 
- Fold04: mstop=750, prune=no 
+ Fold05: mstop=750, prune=no 
- Fold05: mstop=750, prune=no 
+ Fold06: mstop=750, prune=no 
- Fold06: mstop=750, prune=no 
+ Fold07: mstop=750, prune=no 
- Fold07: mstop=750, prune=no 
+ Fold08: mstop=750, prune=no 
- Fold08: mstop=750, prune=no 
+ Fold09: mstop=750, prune=no 
- Fold09: mstop=750, prune=no 
+ Fold10: mstop=750, prune=no 
- Fold10: mstop=750, prune=no 
Aggregating results
Selecting tuning parameters
Fitting mstop = 50, prune = no on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>mi8_ch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Boosted Generalized Linear Model 

51 samples
 7 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 45, 47, 46, 45, 46, 46, ... 
Resampling results across tuning parameters:

  mstop  RMSE      Rsquared   MAE     
   50    16.48753  0.4128394  13.67975
  100    16.79169  0.3982145  13.97998
  150    16.92977  0.3957288  14.13276
  200    17.01209  0.3936998  14.21404
  250    17.03857  0.3926982  14.24698
  300    17.05994  0.3924112  14.26841
  350    17.07437  0.3923462  14.28268
  400    17.08794  0.3921963  14.29518
  450    17.09886  0.3920643  14.30588
  500    17.10689  0.3919927  14.31297
  550    17.11437  0.3919185  14.31966
  600    17.11973  0.3918708  14.32456
  650    17.12452  0.3918192  14.32873
  700    17.12801  0.3917774  14.33178
  750    17.13075  0.3917614  14.33425

Tuning parameter 'prune' was held constant at a value of no
MAE was used to select the optimal model using the smallest value.
The final values used for the model were mstop = 50 and prune = no.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi8_ch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(mi8_ch)<span class="sc">~</span>dane<span class="sc">$</span>chla)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>MAE rośnie wraz z wzrostem iteracji. Po osiągnięciu progu 200 wacha się w okolicach ~14.49</p></li>
<li><p>Oznacza to, że zwiększanie liczby iteracji nie poprawia jakości modelu, a wręcz prowadzi nawet do pogorszenia MAE</p></li>
<li><p>MAE sukcesywnie maleje wraz ze wzrostem liczby iteracji</p></li>
<li><p>Wartość MAE stabilizuje się przy około 700 iteracjach na poziomie około 0.0047, co oznacza bardzo niski błąd predykcji</p></li>
<li><p>Punkty są rozproszone wokół przekątnej, co wskazuje na pewne dopasowanie modelu, ale występują odstępstwa, zwłaszcza dla wyższych wartości chla.</p></li>
<li></li>
</ul>
</section>
</section>
<section id="macierz-its" class="level2">
<h2 class="anchored" data-anchor-id="macierz-its">12. Macierz ITS</h2>
<section id="tworzenie-kombinacji-wag" class="level3">
<h3 class="anchored" data-anchor-id="tworzenie-kombinacji-wag">12.1 Tworzenie kombinacji wag</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>wynik <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">rep</span>(<span class="fu">list</span>(x), <span class="dv">8</span>))</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>mnoznik <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wynik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tworzenie-macierzy" class="level3">
<h3 class="anchored" data-anchor-id="tworzenie-macierzy">12.2 Tworzenie macierzy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">56</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">=</span> <span class="fu">lm</span>(ITS<span class="sc">~</span>.,<span class="at">data =</span> dane[,<span class="fu">c</span>(mnoznik[i,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">1</span>,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                                 mnoznik[i,<span class="dv">2</span>]<span class="sc">*</span><span class="dv">2</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                                 mnoznik[i,<span class="dv">3</span>]<span class="sc">*</span><span class="dv">3</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>                                 mnoznik[i,<span class="dv">4</span>]<span class="sc">*</span><span class="dv">4</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>                                 mnoznik[i,<span class="dv">5</span>]<span class="sc">*</span><span class="dv">5</span>,</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>                                 mnoznik[i,<span class="dv">6</span>]<span class="sc">*</span><span class="dv">6</span>,</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>                                 mnoznik[i,<span class="dv">7</span>]<span class="sc">*</span><span class="dv">7</span>,<span class="dv">8</span>)])</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>pre1 <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(model1))</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>pre1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   predict(model1)
1         7.667101
2         7.790495
3         8.128190
4         7.887680
5         8.170464
6         8.198759
7         7.803403
8         7.928329
9         8.147337
10        8.083205
11        7.865983
12        8.092176
13        8.492469
14        8.450919
15        8.043180
16        8.500009
17        8.175815
18        8.654559
19        8.409216
20        8.118069
21        8.495820
22        8.101924
23        8.625275
24        8.533501
25        8.594464
26        8.282714
27        8.729848
28        7.980105
29        8.561882
30        7.965938
31        8.498699
32        8.505760
33        7.577547
34        8.539355
35        8.466058
36        7.939860
37        8.194521
38        7.946911
39        8.130343
40        8.424351
41        8.274564
42        7.826133
43        8.533519
44        8.406837
45        8.907173
46        8.686898
47        8.351001
48        8.916264
49        8.410980
50        8.982185
51        8.984282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pre1)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dane<span class="sc">$</span>ITS, <span class="at">col =</span> <span class="st">"orange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tworzenie-modeli-dla-różnych-kombinacji-wag" class="level3">
<h3 class="anchored" data-anchor-id="tworzenie-modeli-dla-różnych-kombinacji-wag">12.3 Tworzenie modeli dla różnych kombinacji wag</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przygotowanie pustej ramki danych na wyniki predykcji</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>wyniki_predykcji <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(dane), <span class="at">ncol =</span> <span class="dv">256</span>))</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">256</span>) {</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dodanie modyfikowanych zmiennych z wagami mnoznik[i, ]</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  dane<span class="sc">$</span>modyfikacja <span class="ot">&lt;-</span> mnoznik[i, <span class="dv">1</span>] <span class="sc">*</span> dane<span class="sc">$</span>chla <span class="sc">+</span> </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    mnoznik[i, <span class="dv">2</span>] <span class="sc">*</span> dane<span class="sc">$</span>temp <span class="sc">+</span> </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    mnoznik[i, <span class="dv">3</span>] <span class="sc">*</span> dane<span class="sc">$</span>bar <span class="sc">+</span> </span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    mnoznik[i, <span class="dv">4</span>] <span class="sc">*</span> dane<span class="sc">$</span>nas <span class="sc">+</span> </span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    mnoznik[i, <span class="dv">5</span>] <span class="sc">*</span> dane<span class="sc">$</span>przew <span class="sc">+</span> </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    mnoznik[i, <span class="dv">6</span>] <span class="sc">*</span> dane<span class="sc">$</span>ph <span class="sc">+</span> </span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    mnoznik[i, <span class="dv">7</span>] <span class="sc">*</span> dane<span class="sc">$</span>namon</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tworzenie modelu regresji</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(ITS <span class="sc">~</span> modyfikacja, <span class="at">data =</span> dane)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Obliczanie predykcji dla wszystkich wierszy</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>  predykcja <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> dane)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dodanie wyników predykcji do odpowiedniej kolumny</span></span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>  wyniki_predykcji[, i] <span class="ot">&lt;-</span> predykcja</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodanie nazw kolumn (np. Model_1, Model_2, ..., Model_256)</span></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wyniki_predykcji) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Model_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">256</span>)</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Podgląd wyników</span></span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wyniki_predykcji)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Model_1  Model_2  Model_3  Model_4  Model_5  Model_6  Model_7  Model_8
1 8.293766 8.133086 8.156197 8.092476 8.280171 8.104316 8.238384 8.069886
2 8.293766 8.143978 8.267232 8.130091 8.298180 8.180900 8.301877 8.171506
3 8.293766 8.191440 8.399086 8.211044 8.271166 8.121111 8.248004 8.136009
4 8.293766 8.142422 8.416435 8.163617 8.280171 8.112377 8.274460 8.130441
5 8.293766 8.182881 8.156197 8.144810 8.262161 8.080131 8.190283 8.044829
6 8.293766 8.204667 8.485832 8.245388 8.271166 8.132531 8.260030 8.165242
   Model_9 Model_10 Model_11 Model_12 Model_13 Model_14 Model_15 Model_16
1 8.015120 8.021055 7.963284 7.991216 8.017742 7.993786 7.980503 7.967910
2 8.146754 8.092182 8.138637 8.085206 8.215434 8.123241 8.208586 8.118044
3 8.114511 8.119252 8.162114 8.138954 8.035733 8.052583 8.070498 8.071534
4 8.055350 8.048125 8.111392 8.070724 8.046193 8.018784 8.085978 8.040869
5 8.422149 8.255292 8.362103 8.227374 8.200999 8.146326 8.161318 8.120727
6 8.213014 8.176983 8.294860 8.214563 8.105396 8.105895 8.165033 8.140916
  Model_17 Model_18 Model_19 Model_20 Model_21 Model_22 Model_23 Model_24
1 8.282938 8.212194 8.275711 8.198208 8.277986 8.200263 8.269712 8.186229
2 8.274772 8.180881 8.265928 8.170584 8.273648 8.186955 8.265912 8.177980
3 8.296260 8.280693 8.299239 8.285493 8.290516 8.258925 8.291335 8.262155
4 8.288525 8.237459 8.288404 8.239837 8.284251 8.225129 8.283145 8.226910
5 8.259731 8.127505 8.242276 8.106895 8.247143 8.099400 8.227777 8.078244
6 8.294112 8.274822 8.297691 8.283959 8.288106 8.253147 8.289697 8.260656
  Model_25 Model_26 Model_27 Model_28 Model_29 Model_30 Model_31 Model_32
1 8.193692 8.097420 8.177281 8.079667 8.181156 8.082399 8.165153 8.065552
2 8.170740 8.071013 8.160537 8.062515 8.180938 8.086203 8.172330 8.079029
3 8.279413 8.234677 8.285805 8.242521 8.252584 8.200084 8.257116 8.206971
4 8.229417 8.148778 8.233630 8.155823 8.215473 8.131908 8.218914 8.138687
5 8.133515 8.036472 8.113022 8.017045 8.101520 7.994384 8.080691 7.975466
6 8.283185 8.244875 8.295900 8.260796 8.256208 8.209916 8.266748 8.224521
  Model_33 Model_34 Model_35 Model_36 Model_37 Model_38 Model_39 Model_40
1 7.695967 8.121753 8.077942 8.081051 8.263871 8.093002 8.217489 8.058677
2 7.830482 8.134530 8.229131 8.121084 8.300009 8.173061 8.299901 8.163938
3 8.099511 8.186436 8.415894 8.206987 8.248283 8.114397 8.233479 8.130511
4 7.877562 8.133492 8.423454 8.155862 8.264828 8.103148 8.265275 8.122474
5 8.234026 8.179249 8.113516 8.141100 8.231277 8.073678 8.160907 8.038763
6 8.166768 8.200810 8.531509 8.242849 8.248637 8.126820 8.249469 8.161094
  Model_41 Model_42 Model_43 Model_44 Model_45 Model_46 Model_47 Model_48
1 8.003772 8.014587 7.953292 7.985059 8.006251 7.987371 7.969807 7.961785
2 8.137534 8.087181 8.130043 8.080432 8.207571 8.118420 8.201041 8.113401
3 8.111370 8.117049 8.159071 8.136959 8.030705 8.050147 8.066448 8.069388
4 8.047722 8.043556 8.104034 8.066439 8.037767 8.014156 8.078580 8.036569
5 8.420052 8.254633 8.360251 8.226762 8.199350 8.145397 8.159771 8.119926
6 8.210736 8.175539 8.292137 8.213257 8.101957 8.104229 8.162467 8.139502
  Model_49 Model_50 Model_51 Model_52 Model_53 Model_54 Model_55 Model_56
1 8.280336 8.207424 8.272636 8.193173 8.274884 8.195227 8.266196 8.180978
2 8.270657 8.175279 8.261667 8.165000 8.269944 8.181794 8.262089 8.172845
3 8.296606 8.279658 8.299778 8.284637 8.289817 8.257125 8.290834 8.260559
4 8.287168 8.234156 8.287241 8.236762 8.282334 8.221493 8.281426 8.223518
5 8.252946 8.120964 8.235228 8.100320 8.239405 8.092123 8.219852 8.070997
6 8.294083 8.273746 8.298091 8.283248 8.287067 8.251317 8.289074 8.259203
  Model_57 Model_58 Model_59 Model_60 Model_61 Model_62 Model_63 Model_64
1 8.188150 8.091857 8.171486 8.074068 8.175425 8.076769 8.159231 8.059915
2 8.164876 8.065685 8.154728 8.057324 8.175651 8.081220 8.167098 8.074173
3 8.278239 8.232936 8.284838 8.240940 8.250570 8.197901 8.255344 8.204976
4 8.225742 8.144785 8.230238 8.152070 8.211486 8.127780 8.215225 8.134812
5 8.127778 8.032493 8.107256 8.013157 8.094958 7.989881 8.074179 7.971095
6 8.282376 8.243590 8.295493 8.259769 8.254539 8.208169 8.265499 8.223056
  Model_65 Model_66 Model_67 Model_68 Model_69 Model_70 Model_71 Model_72
1 8.311087 8.133356 8.157554 8.092812 8.280486 8.104652 8.238773 8.070267
2 8.311087 8.144222 8.267041 8.130339 8.298040 8.181057 8.301731 8.171663
3 8.363920 8.191178 8.395346 8.210695 8.271622 8.121073 8.248073 8.135896
4 8.363920 8.142281 8.412454 8.163379 8.280399 8.112360 8.274306 8.130340
5 8.412527 8.182283 8.154269 8.144240 8.262765 8.079881 8.190619 8.044598
6 8.268820 8.205070 8.483963 8.245693 8.271780 8.133069 8.260426 8.165690
  Model_73 Model_74 Model_75 Model_76 Model_77 Model_78 Model_79 Model_80
1 8.015100 8.021222 7.963328 7.991406 8.017880 7.993996 7.980678 7.968137
2 8.146629 8.092276 8.138531 8.085301 8.215350 8.123315 8.208510 8.118119
3 8.113673 8.118973 8.161264 8.138648 8.035328 8.052412 8.070058 8.071337
4 8.054559 8.047919 8.110586 8.070487 8.045776 8.018649 8.085522 8.040703
5 8.420385 8.254557 8.360417 8.226659 8.199929 8.145764 8.160305 8.120187
6 8.213427 8.177266 8.295201 8.214807 8.105853 8.106242 8.165418 8.141222
  Model_81 Model_82 Model_83 Model_84 Model_85 Model_86 Model_87 Model_88
1 8.282991 8.212313 8.275773 8.198341 8.278052 8.200399 8.269788 8.186377
2 8.274870 8.181056 8.266029 8.170764 8.273735 8.187114 8.266001 8.178142
3 8.296218 8.280599 8.299176 8.285381 8.290499 8.258870 8.291301 8.262084
4 8.288525 8.237443 8.288384 8.239802 8.284264 8.225133 8.283139 8.226898
5 8.259871 8.127606 8.242413 8.107000 8.247308 8.099545 8.227940 8.078393
6 8.294120 8.274898 8.297690 8.284021 8.288144 8.253259 8.289727 8.260755
  Model_89 Model_90 Model_91 Model_92 Model_93 Model_94 Model_95 Model_96
1 8.193818 8.097614 8.177421 8.079874 8.181297 8.082608 8.165307 8.065774
2 8.170902 8.071239 8.160703 8.062743 8.181080 8.086408 8.172474 8.079235
3 8.279286 8.234548 8.285656 8.242376 8.252504 8.200004 8.257017 8.206875
4 8.229371 8.148756 8.233562 8.155783 8.215451 8.131911 8.218872 8.138672
5 8.133520 8.036449 8.113028 8.017029 8.101578 7.994420 8.080750 7.975507
6 8.283256 8.245007 8.295954 8.260909 8.256318 8.210087 8.266843 8.224673
  Model_97 Model_98 Model_99 Model_100 Model_101 Model_102 Model_103 Model_104
1 7.686024 8.122027 8.079301  8.081388  8.264206  8.093342  8.217893  8.059059
2 7.820300 8.134774 8.229033  8.121332  8.299870  8.173220  8.299760  8.164097
3 8.055282 8.186160 8.411793  8.206627  8.248646  8.114344  8.233472  8.130385
4 7.833727 8.133340 8.419280  8.155616  8.264975  8.103120  8.265058  8.122366
5 8.158674 8.178623 8.110305  8.140504  8.231702  8.073400  8.161100  8.038505
6 8.182844 8.201217 8.530257  8.243159  8.249311  8.127359  8.249907  8.161542
  Model_105 Model_106 Model_107 Model_108 Model_109 Model_110 Model_111
1  8.003740  8.014751  7.953323  7.985245  8.006378  7.987576  7.969970
2  8.137406  8.087273  8.129936  8.080525  8.207488  8.118493  8.200966
3  8.110526  8.116766  8.158223  8.136650  8.030279  8.049970  8.065994
4  8.046925  8.043345  8.103229  8.066198  8.037334  8.014015  8.078113
5  8.418310  8.253895  8.358586  8.226046  8.198265  8.144830  8.158745
6  8.211143  8.175820  8.292478  8.213499  8.102405  8.104571  8.162847
  Model_112 Model_113 Model_114 Model_115 Model_116 Model_117 Model_118
1  7.962008  8.280391  8.207546  8.272701  8.193309  8.274953  8.195365
2  8.113475  8.270757  8.175457  8.261771  8.165183  8.270033  8.181956
3  8.069185  8.296558  8.279561  8.299710  8.284521  8.289797  8.257068
4  8.036399  8.287165  8.234139  8.287218  8.236726  8.282344  8.221496
5  8.119380  8.253081  8.121061  8.235360  8.100421  8.239566  8.092264
6  8.139805  8.294093  8.273825  8.298092  8.283313  8.287107  8.251432
  Model_119 Model_120 Model_121 Model_122 Model_123 Model_124 Model_125
1  8.266274  8.181130  8.188278  8.092052  8.171628  8.074276  8.175569
2  8.262181  8.173010  8.165040  8.065912  8.154896  8.057552  8.175795
3  8.290795  8.260484  8.278107  8.232806  8.284686  8.240793  8.250486
4  8.281418  8.223504  8.225693  8.144762  8.230167  8.152028  8.211463
5  8.220012  8.071143  8.127775  8.032465  8.107255  8.013135  8.095009
6  8.289107  8.259305  8.282450  8.243723  8.295550  8.259884  8.254652
  Model_126 Model_127 Model_128 Model_129 Model_130 Model_131 Model_132
1  8.076980  8.159388  8.060138  8.293766  8.133086  8.156197  8.092476
2  8.081426  8.167243  8.074379  8.293766  8.143978  8.267232  8.130091
3  8.197819  8.255242  8.204878  8.293766  8.191440  8.399086  8.211044
4  8.127781  8.215182  8.134796  8.293766  8.142422  8.416435  8.163617
5  7.989912  8.074232  7.971130  8.293766  8.182881  8.156197  8.144810
6  8.208341  8.265596  8.223210  8.293766  8.204667  8.485832  8.245388
  Model_133 Model_134 Model_135 Model_136 Model_137 Model_138 Model_139
1  8.280171  8.104316  8.238384  8.069886  8.015120  8.021055  7.963284
2  8.298180  8.180900  8.301877  8.171506  8.146754  8.092182  8.138637
3  8.271166  8.121111  8.248004  8.136009  8.114511  8.119252  8.162114
4  8.280171  8.112377  8.274460  8.130441  8.055350  8.048125  8.111392
5  8.262161  8.080131  8.190283  8.044829  8.422149  8.255292  8.362103
6  8.271166  8.132531  8.260030  8.165242  8.213014  8.176983  8.294860
  Model_140 Model_141 Model_142 Model_143 Model_144 Model_145 Model_146
1  7.991216  8.017742  7.993786  7.980503  7.967910  8.282938  8.212194
2  8.085206  8.215434  8.123241  8.208586  8.118044  8.274772  8.180881
3  8.138954  8.035733  8.052583  8.070498  8.071534  8.296260  8.280693
4  8.070724  8.046193  8.018784  8.085978  8.040869  8.288525  8.237459
5  8.227374  8.200999  8.146326  8.161318  8.120727  8.259731  8.127505
6  8.214563  8.105396  8.105895  8.165033  8.140916  8.294112  8.274822
  Model_147 Model_148 Model_149 Model_150 Model_151 Model_152 Model_153
1  8.275711  8.198208  8.277986  8.200263  8.269712  8.186229  8.193692
2  8.265928  8.170584  8.273648  8.186955  8.265912  8.177980  8.170740
3  8.299239  8.285493  8.290516  8.258925  8.291335  8.262155  8.279413
4  8.288404  8.239837  8.284251  8.225129  8.283145  8.226910  8.229417
5  8.242276  8.106895  8.247143  8.099400  8.227777  8.078244  8.133515
6  8.297691  8.283959  8.288106  8.253147  8.289697  8.260656  8.283185
  Model_154 Model_155 Model_156 Model_157 Model_158 Model_159 Model_160
1  8.097420  8.177281  8.079667  8.181156  8.082399  8.165153  8.065552
2  8.071013  8.160537  8.062515  8.180938  8.086203  8.172330  8.079029
3  8.234677  8.285805  8.242521  8.252584  8.200084  8.257116  8.206971
4  8.148778  8.233630  8.155823  8.215473  8.131908  8.218914  8.138687
5  8.036472  8.113022  8.017045  8.101520  7.994384  8.080691  7.975466
6  8.244875  8.295900  8.260796  8.256208  8.209916  8.266748  8.224521
  Model_161 Model_162 Model_163 Model_164 Model_165 Model_166 Model_167
1  7.695967  8.121753  8.077942  8.081051  8.263871  8.093002  8.217489
2  7.830482  8.134530  8.229131  8.121084  8.300009  8.173061  8.299901
3  8.099511  8.186436  8.415894  8.206987  8.248283  8.114397  8.233479
4  7.877562  8.133492  8.423454  8.155862  8.264828  8.103148  8.265275
5  8.234026  8.179249  8.113516  8.141100  8.231277  8.073678  8.160907
6  8.166768  8.200810  8.531509  8.242849  8.248637  8.126820  8.249469
  Model_168 Model_169 Model_170 Model_171 Model_172 Model_173 Model_174
1  8.058677  8.003772  8.014587  7.953292  7.985059  8.006251  7.987371
2  8.163938  8.137534  8.087181  8.130043  8.080432  8.207571  8.118420
3  8.130511  8.111370  8.117049  8.159071  8.136959  8.030705  8.050147
4  8.122474  8.047722  8.043556  8.104034  8.066439  8.037767  8.014156
5  8.038763  8.420052  8.254633  8.360251  8.226762  8.199350  8.145397
6  8.161094  8.210736  8.175539  8.292137  8.213257  8.101957  8.104229
  Model_175 Model_176 Model_177 Model_178 Model_179 Model_180 Model_181
1  7.969807  7.961785  8.280336  8.207424  8.272636  8.193173  8.274884
2  8.201041  8.113401  8.270657  8.175279  8.261667  8.165000  8.269944
3  8.066448  8.069388  8.296606  8.279658  8.299778  8.284637  8.289817
4  8.078580  8.036569  8.287168  8.234156  8.287241  8.236762  8.282334
5  8.159771  8.119926  8.252946  8.120964  8.235228  8.100320  8.239405
6  8.162467  8.139502  8.294083  8.273746  8.298091  8.283248  8.287067
  Model_182 Model_183 Model_184 Model_185 Model_186 Model_187 Model_188
1  8.195227  8.266196  8.180978  8.188150  8.091857  8.171486  8.074068
2  8.181794  8.262089  8.172845  8.164876  8.065685  8.154728  8.057324
3  8.257125  8.290834  8.260559  8.278239  8.232936  8.284838  8.240940
4  8.221493  8.281426  8.223518  8.225742  8.144785  8.230238  8.152070
5  8.092123  8.219852  8.070997  8.127778  8.032493  8.107256  8.013157
6  8.251317  8.289074  8.259203  8.282376  8.243590  8.295493  8.259769
  Model_189 Model_190 Model_191 Model_192 Model_193 Model_194 Model_195
1  8.175425  8.076769  8.159231  8.059915  8.311087  8.133356  8.157554
2  8.175651  8.081220  8.167098  8.074173  8.311087  8.144222  8.267041
3  8.250570  8.197901  8.255344  8.204976  8.363920  8.191178  8.395346
4  8.211486  8.127780  8.215225  8.134812  8.363920  8.142281  8.412454
5  8.094958  7.989881  8.074179  7.971095  8.412527  8.182283  8.154269
6  8.254539  8.208169  8.265499  8.223056  8.268820  8.205070  8.483963
  Model_196 Model_197 Model_198 Model_199 Model_200 Model_201 Model_202
1  8.092812  8.280486  8.104652  8.238773  8.070267  8.015100  8.021222
2  8.130339  8.298040  8.181057  8.301731  8.171663  8.146629  8.092276
3  8.210695  8.271622  8.121073  8.248073  8.135896  8.113673  8.118973
4  8.163379  8.280399  8.112360  8.274306  8.130340  8.054559  8.047919
5  8.144240  8.262765  8.079881  8.190619  8.044598  8.420385  8.254557
6  8.245693  8.271780  8.133069  8.260426  8.165690  8.213427  8.177266
  Model_203 Model_204 Model_205 Model_206 Model_207 Model_208 Model_209
1  7.963328  7.991406  8.017880  7.993996  7.980678  7.968137  8.282991
2  8.138531  8.085301  8.215350  8.123315  8.208510  8.118119  8.274870
3  8.161264  8.138648  8.035328  8.052412  8.070058  8.071337  8.296218
4  8.110586  8.070487  8.045776  8.018649  8.085522  8.040703  8.288525
5  8.360417  8.226659  8.199929  8.145764  8.160305  8.120187  8.259871
6  8.295201  8.214807  8.105853  8.106242  8.165418  8.141222  8.294120
  Model_210 Model_211 Model_212 Model_213 Model_214 Model_215 Model_216
1  8.212313  8.275773  8.198341  8.278052  8.200399  8.269788  8.186377
2  8.181056  8.266029  8.170764  8.273735  8.187114  8.266001  8.178142
3  8.280599  8.299176  8.285381  8.290499  8.258870  8.291301  8.262084
4  8.237443  8.288384  8.239802  8.284264  8.225133  8.283139  8.226898
5  8.127606  8.242413  8.107000  8.247308  8.099545  8.227940  8.078393
6  8.274898  8.297690  8.284021  8.288144  8.253259  8.289727  8.260755
  Model_217 Model_218 Model_219 Model_220 Model_221 Model_222 Model_223
1  8.193818  8.097614  8.177421  8.079874  8.181297  8.082608  8.165307
2  8.170902  8.071239  8.160703  8.062743  8.181080  8.086408  8.172474
3  8.279286  8.234548  8.285656  8.242376  8.252504  8.200004  8.257017
4  8.229371  8.148756  8.233562  8.155783  8.215451  8.131911  8.218872
5  8.133520  8.036449  8.113028  8.017029  8.101578  7.994420  8.080750
6  8.283256  8.245007  8.295954  8.260909  8.256318  8.210087  8.266843
  Model_224 Model_225 Model_226 Model_227 Model_228 Model_229 Model_230
1  8.065774  7.686024  8.122027  8.079301  8.081388  8.264206  8.093342
2  8.079235  7.820300  8.134774  8.229033  8.121332  8.299870  8.173220
3  8.206875  8.055282  8.186160  8.411793  8.206627  8.248646  8.114344
4  8.138672  7.833727  8.133340  8.419280  8.155616  8.264975  8.103120
5  7.975507  8.158674  8.178623  8.110305  8.140504  8.231702  8.073400
6  8.224673  8.182844  8.201217  8.530257  8.243159  8.249311  8.127359
  Model_231 Model_232 Model_233 Model_234 Model_235 Model_236 Model_237
1  8.217893  8.059059  8.003740  8.014751  7.953323  7.985245  8.006378
2  8.299760  8.164097  8.137406  8.087273  8.129936  8.080525  8.207488
3  8.233472  8.130385  8.110526  8.116766  8.158223  8.136650  8.030279
4  8.265058  8.122366  8.046925  8.043345  8.103229  8.066198  8.037334
5  8.161100  8.038505  8.418310  8.253895  8.358586  8.226046  8.198265
6  8.249907  8.161542  8.211143  8.175820  8.292478  8.213499  8.102405
  Model_238 Model_239 Model_240 Model_241 Model_242 Model_243 Model_244
1  7.987576  7.969970  7.962008  8.280391  8.207546  8.272701  8.193309
2  8.118493  8.200966  8.113475  8.270757  8.175457  8.261771  8.165183
3  8.049970  8.065994  8.069185  8.296558  8.279561  8.299710  8.284521
4  8.014015  8.078113  8.036399  8.287165  8.234139  8.287218  8.236726
5  8.144830  8.158745  8.119380  8.253081  8.121061  8.235360  8.100421
6  8.104571  8.162847  8.139805  8.294093  8.273825  8.298092  8.283313
  Model_245 Model_246 Model_247 Model_248 Model_249 Model_250 Model_251
1  8.274953  8.195365  8.266274  8.181130  8.188278  8.092052  8.171628
2  8.270033  8.181956  8.262181  8.173010  8.165040  8.065912  8.154896
3  8.289797  8.257068  8.290795  8.260484  8.278107  8.232806  8.284686
4  8.282344  8.221496  8.281418  8.223504  8.225693  8.144762  8.230167
5  8.239566  8.092264  8.220012  8.071143  8.127775  8.032465  8.107255
6  8.287107  8.251432  8.289107  8.259305  8.282450  8.243723  8.295550
  Model_252 Model_253 Model_254 Model_255 Model_256
1  8.074276  8.175569  8.076980  8.159388  8.060138
2  8.057552  8.175795  8.081426  8.167243  8.074379
3  8.240793  8.250486  8.197819  8.255242  8.204878
4  8.152028  8.211463  8.127781  8.215182  8.134796
5  8.013135  8.095009  7.989912  8.074232  7.971130
6  8.259884  8.254652  8.208341  8.265596  8.223210</code></pre>
</div>
</div>
</section>
<section id="tworzenie-heatmapy" class="level3">
<h3 class="anchored" data-anchor-id="tworzenie-heatmapy">12.4 Tworzenie heatmapy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Konwersja wszystkich wartości w ramce danych na liczby (jeśli to możliwe)</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>wyniki_predykcji[] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(wyniki_predykcji, as.numeric)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ponownie konwertujemy na macierz</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>wyniki_predykcji_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(wyniki_predykcji)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie heatmap</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(wyniki_predykcji_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>wyniki_predykcji<span class="sc">$</span>numer <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">51</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>wlong<span class="ot">=</span>wyniki_predykcji <span class="sc">%&gt;%</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">256</span>))</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> wlong, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> numer, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ocena-dopasowania-modeli-hydrologicznych" class="level2">
<h2 class="anchored" data-anchor-id="ocena-dopasowania-modeli-hydrologicznych">13 Ocena dopasowania modeli hydrologicznych</h2>
<section id="obliczenie-metryk-dopasowania-modelu" class="level3">
<h3 class="anchored" data-anchor-id="obliczenie-metryk-dopasowania-modelu">13.1 Obliczenie metryk dopasowania modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie wartości przewidywanych</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rzeczywiste wartości</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> dane<span class="sc">$</span>ITS</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co"># NSE (Nash-Sutcliffe Efficiency)</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>nse_value <span class="ot">&lt;-</span> <span class="fu">NSE</span>(predicted, observed)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>rmse_value <span class="ot">&lt;-</span> <span class="fu">rmse</span>(predicted, observed)</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MAE</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>mae_value <span class="ot">&lt;-</span> <span class="fu">mae</span>(predicted, observed)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie wyników</span></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"NSE:"</span>, nse_value, <span class="st">"</span><span class="sc">\n</span><span class="st">RMSE:"</span>, rmse_value, <span class="st">"</span><span class="sc">\n</span><span class="st">MAE:"</span>, mae_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NSE: 0.196978 
RMSE: 0.3155636 
MAE: 0.2563924</code></pre>
</div>
</div>
<p><strong>Wyniki metryk dopasowania modelu:</strong> NSE (Nash-Sutcliffe Efficiency): 0.196978</p>
<p>NSE w zakresie od 0 do 1 wskazuje na jakość dopasowania modelu do danych. Wartość 0.2 sugeruje, że model nie przewiduje dobrze zmiennej zależnej (ITS). Wynik jest niski, co oznacza, że model tylko minimalnie lepiej opisuje dane niż prosta średnia wartości rzeczywistych. RMSE (Root Mean Square Error): 0.3155636</p>
<p>RMSE mierzy średnią różnicę między wartościami rzeczywistymi a przewidywanymi. Im niższa wartość, tym lepsze dopasowanie modelu. RMSE w tym przypadku wskazuje na umiarkowaną różnicę między wartościami przewidywanymi a rzeczywistymi. MAE (Mean Absolute Error): 0.2563924</p>
<p>MAE mierzy przeciętny błąd bezwzględny między rzeczywistymi a przewidywanymi wartościami. Podobnie jak RMSE, im niższa wartość, tym lepsze dopasowanie. MAE pokazuje, że średni błąd w przewidywaniach wynosi około 0.26 jednostki.</p>
</section>
<section id="analiza-błędów-modelu" class="level3">
<h3 class="anchored" data-anchor-id="analiza-błędów-modelu">13.2 Analiza błędów modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie reszt</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span> observed <span class="sc">-</span> predicted</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram błędów</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(errors, <span class="at">main =</span> <span class="st">"Histogram błędów"</span>, <span class="at">xlab =</span> <span class="st">"Błąd (Rzeczywiste - Przewidywane)"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taylor Diagram (jeśli korelacja i odchylenie standardowe są dostępne)</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">taylor.diagram</span>(observed, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Histogram błędów:</strong> Interpretacja: Histogram przedstawia rozkład błędów (reszt) modelu. Wnioski: Większość błędów jest bliska 0, co oznacza, że model generalnie dobrze dopasowuje dane. Istnieją pewne błędy w większych przedziałach (-0.4 do -0.6 i 0.6 do 0.8), co wskazuje na możliwe trudności modelu w przewidywaniu niektórych przypadków. <strong>Taylor Diagram (prawy wykres):</strong> Interpretacja: Taylor diagram umożliwia graficzną ocenę dopasowania modelu w oparciu o: Korelację (correlation): Jak dobrze przewidywania modelu są skorelowane z wartościami rzeczywistymi. Standardowe odchylenie (standard deviation): Zróżnicowanie danych w przewidywaniach i obserwacjach. RMSE (Root Mean Square Error): Błąd średniokwadratowy. Wnioski: Korelacja jest niska (około 0.2–0.3), co potwierdza słabe dopasowanie modelu. Standardowe odchylenie wskazuje na niedoskonałą reprezentację zmienności danych.</p>
<p><strong>Ogólne wnioski:</strong> Jakość modelu: Model regresji liniowej nie przewiduje zmiennej ITS wystarczająco dobrze. Wyniki NSE i korelacji są niskie, co sugeruje potrzebę poprawy modelu.</p>
<p>Potencjalne działania:</p>
<p>Rozważyć dodanie innych zmiennych objaśniających lub bardziej nieliniowych zależności (np. modele z interakcjami lub nieliniowe modele regresji). Sprawdzić, czy dane zawierają wartości odstające, które mogą wpływać na dopasowanie. Zastosować bardziej zaawansowane modele, takie jak random forest, SVM, czy regresję regularizowaną (Lasso/Ridge). Korzystanie z metryk: Metryki RMSE i MAE wskazują, że model umiarkowanie radzi sobie z przewidywaniem, ale nadal pozostawia miejsce na poprawę. Taylor Diagram potwierdza, że przewidywana zmienność jest mniejsza niż obserwowana.</p>
</section>
<section id="eksploracja-zmiennych-przyczynowych--sem" class="level3">
<h3 class="anchored" data-anchor-id="eksploracja-zmiennych-przyczynowych--sem">13.3 Eksploracja zmiennych przyczynowych- SEM</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>model_sem <span class="ot">&lt;-</span> <span class="st">'ITS ~ chla + temp + nas</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="st">              temp ~ nas'</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_sem, <span class="at">data =</span> dane)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 2 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         6

  Number of observations                            51

Model Test User Model:
                                                      
  Test statistic                                 0.034
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.854

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ITS ~                                               
    chla              0.003    0.002    1.331    0.183
    temp              0.022    0.011    1.981    0.048
    nas               0.012    0.003    4.172    0.000
  temp ~                                              
    nas               0.045    0.031    1.471    0.141

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .ITS               0.067    0.013    5.050    0.000
   .temp             10.788    2.136    5.050    0.000</code></pre>
</div>
</div>
<ul>
<li>Statystyki dopasowania sugerują, że model dobrze pasuje do danych (wysokie p-value dla testu chi-kwadrat, brak dowodów na niedopasowanie)</li>
<li><strong>nas:</strong> silny i istotny wpływ na ITS (p &lt; 0.001), co sugeruje, że jest to kluczowa zmienna wyjaśniająca</li>
<li><strong>chla:</strong> Nieistotny wpływ na ITS (p = 0.183), może być mniej ważna w kontekście tego modelu</li>
</ul>
</section>
<section id="wykres-ścieżek" class="level3">
<h3 class="anchored" data-anchor-id="wykres-ścieżek">13.4 Wykres ścieżek</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu ścieżek</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(fit, </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">whatLabels =</span> <span class="st">"std"</span>, <span class="co"># Wyświetlanie standardowych współczynników</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">style =</span> <span class="st">"lisrel"</span>, </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layout =</span> <span class="st">"tree"</span>, </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge.label.cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nCharNodes =</span> <span class="dv">0</span>, </span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sizeMan =</span> <span class="dv">7</span>, </span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sizeLat =</span> <span class="dv">9</span>,</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Zmienna nas ma największy wpływ na ITS (współczynnik 0.51), co potwierdza wcześniejsze analizy.</li>
<li>Zmienna temp ma umiarkowany wpływ na ITS (0.21), ale także jest zależne od nas (0.20), co wskazuje na złożone zależności.</li>
<li>Zmienna nas wpływa na ITS zarówno bezpośrednio (0.51), jak i pośrednio przez temp.</li>
</ul>
</section>
</section>
<section id="metody-regularyzacji-ridge-i-lasso" class="level2">
<h2 class="anchored" data-anchor-id="metody-regularyzacji-ridge-i-lasso">14. Metody regularyzacji (Ridge i Lasso)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dane[, <span class="fu">c</span>(<span class="st">"chla"</span>, <span class="st">"temp"</span>, <span class="st">"bar"</span>, <span class="st">"nas"</span>, <span class="st">"przew"</span>, <span class="st">"ph"</span>, <span class="st">"namon"</span>)])</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> dane<span class="sc">$</span>ITS</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>model_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="co"># Lasso</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>model_ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>) <span class="co"># Ridge</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres dla modelu Lasso</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_lasso)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Wykres Lasso: Współczynniki vs. Lambda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres dla modelu Ridge</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_ridge)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Wykres Ridge: Współczynniki vs. Lambda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatywnie, porównanie obu modeli na jednym wykresie</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># Ustawienie dwóch wykresów obok siebie</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_lasso, <span class="at">main =</span> <span class="st">"Lasso"</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_ridge, <span class="at">main =</span> <span class="st">"Ridge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-51-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Resetowanie ustawienia wykresów</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Optymalne λ:</strong></p>
<p>Na wykresach można zauważyć wartość λ, która minimalizuje MSE (najlepszy kompromis między prostotą modelu a jego dopasowaniem). Jest to wartość, przy której model jest najlepiej dopasowany bez przeuczenia.</p>
<p><strong>Regularyzacja:</strong> Ridge lepiej radzi sobie z dużą liczbą skorelowanych zmiennych, ponieważ zachowuje wszystkie cechy. Lasso eliminuje nieistotne zmienne, co upraszcza model.</p>
<p><strong>Wybór metody:</strong> W zależności od danych i celu analizy należy wybrać odpowiednią metodę: Lasso: Gdy kluczowe jest uproszczenie modelu. Ridge: Gdy każda zmienna wnosi istotną informację.</p>
</section>
<section id="gam-model" class="level2">
<h2 class="anchored" data-anchor-id="gam-model">15. Gam model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(ITS <span class="sc">~</span> <span class="fu">s</span>(chla) <span class="sc">+</span> <span class="fu">s</span>(temp) <span class="sc">+</span> <span class="fu">s</span>(nas) <span class="sc">+</span> <span class="fu">s</span>(przew), <span class="at">data =</span> dane)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
ITS ~ s(chla) + s(temp) + s(nas) + s(przew)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.29377    0.02424   342.1   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
           edf Ref.df      F  p-value    
s(chla)  1.000  1.000  1.311   0.2593    
s(temp)  4.286  5.165  8.480 1.81e-05 ***
s(nas)   2.483  3.016 14.198 2.44e-06 ***
s(przew) 4.175  4.869  3.319   0.0161 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.763   Deviance explained =   82%
GCV = 0.040168  Scale est. = 0.029973  n = 51</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja nieliniowych efektów</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gam_model, <span class="at">pages =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Model GAM ujawnił nieliniowe zależności między zmiennymi (chla, temp, nas, przew) a ITS, szczególnie zauważalne w wyższych zakresach wartości. Najsilniejszy wpływ na ITS mają zmienne chla i nas, podczas gdy temp i przew wykazują bardziej subtelne zależności. Model ten jest bardziej adekwatny do analizy złożonych, nieliniowych relacji niż modele liniowe. Zaleca się dalszą weryfikację modelu na nowych danych oraz rozważenie dodania dodatkowych zmiennych w celu poprawy dopasowania</li>
</ul>
</section>
<section id="inne-wykresy" class="level2">
<h2 class="anchored" data-anchor-id="inne-wykresy">16. Inne wykresy</h2>
<section id="zależność-między-chlorofilem-a-its" class="level3">
<h3 class="anchored" data-anchor-id="zależność-między-chlorofilem-a-its">16.1 Zależność między chlorofilem a ITS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> chla, <span class="at">y =</span> ITS, <span class="at">color =</span> temp)) <span class="sc">+</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Temperatura"</span>) <span class="sc">+</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zależność między Chlorofilem a ITS"</span>,</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Chlorofil"</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Indeks ITS"</span>) <span class="sc">+</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Zależność między stężeniem chlorofilu-a a indeksem ITS wydaje się dodatnia (wyższe stężenie chlorofilu jest związane z wyższym ITS)</li>
</ul>
</section>
<section id="rozkład-chlorofilu" class="level3">
<h3 class="anchored" data-anchor-id="rozkład-chlorofilu">16.2 Rozkład chlorofilu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> chla)) <span class="sc">+</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Chlorofilu"</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Chlorofil"</span>,</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Gęstość"</span>) <span class="sc">+</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Większość wartości stężenia chlorofilu-a znajduje się w dolnym zakresie (0–25), co może wskazywać na tendencję do niskich stężeń w zbiorze danych</p></li>
<li><p>Obserwuje się pojedyncze wartości w wyższych zakresach (np. powyżej 75), co może być wynikiem specyficznych warunków środowiskowych lub odchyleń</p></li>
</ul>
</section>
<section id="zależność-między-chlorofilem-its-i-przewodnością" class="level3">
<h3 class="anchored" data-anchor-id="zależność-między-chlorofilem-its-i-przewodnością">16.3 Zależność między chlorofilem, ITS i przewodnością</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> chla, <span class="at">y =</span> ITS, <span class="at">size =</span> nas, <span class="at">color =</span> ph)) <span class="sc">+</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"green"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"pH"</span>) <span class="sc">+</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zależność między Chlorofilem, ITS i przewodnością"</span>,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Chlorofil (chla)"</span>,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ITS"</span>,</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"Przewodność (nas)"</span>) <span class="sc">+</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Wykres punktowy wskazuje na zależność między chlorofilem-a a ITS, z przewodnością jako trzecią zmienną reprezentowaną przez wielkość punktów. Widać, że przy wyższym pH (oznaczonym ciepłymi kolorami) ITS jest wyższy, co może sugerować wpływ pH na ITS oraz korelację z koncentracją chlorofilu.</li>
</ul>
</section>
<section id="rozkład-its-w-różnych-kategoriach-wody" class="level3">
<h3 class="anchored" data-anchor-id="rozkład-its-w-różnych-kategoriach-wody">16.4 Rozkład ITS w różnych kategoriach wody</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podział na kategorie jakości wody</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>dane<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="fu">cut</span>(dane<span class="sc">$</span>chla, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="cn">Inf</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Good"</span>, <span class="st">"Moderate"</span>, <span class="st">"Poor"</span>))</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> quality, <span class="at">y =</span> ITS, <span class="at">fill =</span> quality)) <span class="sc">+</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Good"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Moderate"</span> <span class="ot">=</span> <span class="st">"yellow"</span>, <span class="st">"Poor"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład ITS w różnych kategoriach jakości wody"</span>,</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Jakość wody"</span>,</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ITS"</span>) <span class="sc">+</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sprawozdanie_jeziora_KB_KK_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Wykres skrzypcowy ilustruje, że ITS jest najwyższy dla wody o słabej jakości, a najniższy dla wody o dobrej jakości. Woda o umiarkowanej jakości ma ITS pomiędzy tymi wartościami. Rozkład sugeruje, że jakość wody może być skorelowana z ITS</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>